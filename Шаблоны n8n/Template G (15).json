{
  "name": "Template G",
  "nodes": [
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ JSON.stringify({\n  // –î–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–∫–∞–∫ –±—ã–ª–æ)\n  chat_id: $json.message.chat.id,\n  message_id: $json.message.message_id,\n  text: $json.message.text ?? null,\n  photo_file_id: $json.message.photo ? $json.message.photo[$json.message.photo.length - 1].file_id : null,\n  document_file_id: $json.message.document?.file_id ?? null,\n\n  // –í–ê–ñ–ù–û: –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –ë–î\n  db_status: $json.status,\n  db_title: $json.title_seed,\n  db_factpack: $json.factpack,\n  db_image_id: $json.draft_image_file_id\n}, null, 2) }}",
        "options": {
          "systemMessage": "You are the \"Intake Manager\" for a product review pipeline. Your ONLY goal is to gather a Title, optional Details, and a Photo, then output \"READY\".\n\n### 1. CURRENT CONTEXT (from JSON input)\n- **Title:** The user message JSON contains `db_title`. If present, it is LOCKED.\n- **Status:** The user message JSON contains `db_status`.\n- **Has Image:** {{ $json.draft_image_file_id ? \"YES\" : \"NO\" }}\n- **Factpack:** The user message JSON contains `db_factpack`.\n\n### 2. STEP 1: INPUT ANALYSIS & FILTERING (CRITICAL)\nBefore deciding to update DB, analyze the User Input:\n- **Noise Filter:** If input is a generic greeting (\"–ü—Ä–∏–≤–µ—Ç\", \"Start\", \"Go\", \"–ù—É–∂–µ–Ω –æ–±–∑–æ—Ä\", \"–û—Ç–ø—Ä–∞–≤—å —Ç–æ–≤–∞—Ä\") -> **IGNORE IT**. Return `{}`. Do NOT save this as description.\n- **Skip Logic:** If input is \"no\", \"skip\", \"nothing\", \"–Ω–µ—Ç\" -> **IGNORE IT**. Return `{}`. Proceed to Photo phase.\n- **Valid Content:** Only if input contains ACTUAL product specs/details -> Save to `description` or `specs`.\n\n### 3. STEP 2: STRICT JSON RULES\nWhen calling `upsert_review_tool` via `factpack_patch`:\n1. **Allowed Keys:** ONLY \"description\", \"specs\", \"price\", \"notes\".\n2. **Forbidden Keys:** NEVER include \"status\", \"id\", \"chat_id\", \"title_seed\", \"factpack\", \"draft_image_file_id\", \"latest_user_message\".\n3. **Empty Patch:** If input was Noise or Skip -> send `{}`.\n\n### 4. STEP 3: LOGIC & RESPONSES (Russian)\n\n**PHASE 1: IMAGE RECEIVED (Success)**\nIF (Input is Photo OR `db_image_id` exists):\n   - Action: Save photo (auto-handled).\n   - Reply: \"READY. –§–æ—Ç–æ –ø–æ–ª—É—á–µ–Ω–æ. –ù–∞—á–∏–Ω–∞—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –æ–±–∑–æ—Ä–∞...\"\n   - Stop: Do not ask anything else.\n\n**PHASE 2: MISSING TITLE**\nIF (`db_title` is empty/null):\n   - Action: Save user text as Title (if not Noise).\n   - Reply: \"–ü—Ä–∏–≤–µ—Ç! –ù–∞–ø–∏—à–∏ —Ç–æ—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –¥–ª—è –æ–±–∑–æ—Ä–∞.\"\n\n**PHASE 3: MISSING DETAILS**\nIF (`db_title` exists AND `db_factpack` has no meaningful description/specs AND Input is NOT \"skip\"/\"no\"):\n   - Action: Save user text as `description` (ONLY if it passes Noise Filter).\n   - Reply: \"–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç–æ. –ï—Å—Ç—å –æ—Å–æ–±—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ? –ò–ª–∏ –Ω–∞–ø–∏—à–∏ '–Ω–µ—Ç', —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –∫ —Ñ–æ—Ç–æ.\"\n\n**PHASE 4: ASK FOR PHOTO**\nIF (`db_title` exists AND (Details exist OR User said \"skip\"/\"no\")):\n   - Action: Send `{}` to tool.\n   - Reply: \"–î–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∞–ª. –¢–µ–ø–µ—Ä—å –ø—Ä–∏—à–ª–∏ —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞ –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º.\""
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        -4224,
        1216
      ],
      "id": "13808c5d-69c0-49d0-9521-d82e71371a8d",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-5-mini",
          "mode": "list",
          "cachedResultName": "gpt-5-mini"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -4224,
        1408
      ],
      "id": "bbfae449-2296-4f43-b21d-2ba501a5909b",
      "name": "OpenAI Chat Model4",
      "credentials": {
        "openAiApi": {
          "id": "U1pcqbZS37eHdBPO",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-5.2",
          "mode": "list",
          "cachedResultName": "gpt-5.2"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -2576,
        1408
      ],
      "id": "6b55c9e2-123a-4b11-bef5-75fca2100811",
      "name": "OpenAI Chat Model5",
      "credentials": {
        "openAiApi": {
          "id": "U1pcqbZS37eHdBPO",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-5.2",
          "mode": "list",
          "cachedResultName": "gpt-5.2"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -2224,
        1408
      ],
      "id": "9b8fa27f-cb95-49ad-b549-0e1c0ea2029d",
      "name": "OpenAI Chat Model6",
      "credentials": {
        "openAiApi": {
          "id": "U1pcqbZS37eHdBPO",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-5.2",
          "mode": "list",
          "cachedResultName": "gpt-5.2"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -1904,
        1424
      ],
      "id": "9609ec6c-81c9-4a4f-afb9-e752a9e9bca6",
      "name": "OpenAI Chat Model7",
      "credentials": {
        "openAiApi": {
          "id": "U1pcqbZS37eHdBPO",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "7022e65f-0e7e-403d-baaf-a51a2bf7c32d",
              "leftValue": "={{ $json.result.text }}",
              "rightValue": "READY",
              "operator": {
                "type": "string",
                "operation": "startsWith"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        -3536,
        1216
      ],
      "id": "979b4bb2-bea4-463f-979c-aa72773b4894",
      "name": "If"
    },
    {
      "parameters": {
        "updates": [
          "message",
          "callback_query"
        ],
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        -6080,
        1200
      ],
      "id": "ce8020c4-cd79-4454-984e-0c9623f5119f",
      "name": "Telegram Trigger",
      "webhookId": "6a7620e2-23de-4570-8c58-51b96032d899",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "This tool upserts a review draft in public.review_items.\n\nRules:\n- Allowed status values: intake, brief_ready, await_manual_image, drafts_ready, approve2_sent, published, rejected.\n- On INSERT always set status = 'intake'. Never insert with any other status.\n- NEVER create multiple rows for the same chat if there is an existing open draft.\n\nOpen draft = latest row for this chat with status IN ('intake','brief_ready','await_manual_image','drafts_ready').\n\nInputs (positional params):\n$1 = user_chat_id (int)\n$2 = title_seed (text, nullable)\n$3 = factpack_json (json string, nullable)\n\nOutput: returns [{ id, status, title_seed, factpack, draft_image_file_id }]\n",
        "operation": "executeQuery",
        "query": "WITH existing AS (\n  SELECT id\n  FROM public.review_items\n  WHERE user_chat_id = $1\n    AND status IN ('intake','brief_ready','await_manual_image','drafts_ready')\n  ORDER BY created_at DESC\n  LIMIT 1\n),\nupd AS (\n  UPDATE public.review_items\n  SET\n    -- do NOT overwrite title_seed once it is set\n    title_seed = COALESCE(NULLIF(title_seed, ''), $2),\n\n    -- merge jsonb patches, keep old fields\n    factpack = COALESCE(factpack, '{}'::jsonb)\n              || COALESCE($3::jsonb, '{}'::jsonb)\n              || CASE WHEN $2 IS NOT NULL THEN jsonb_build_object('latest_user_message', $2) ELSE '{}'::jsonb END,\n\n    -- save file_id if present\n    draft_image_file_id = COALESCE($4, draft_image_file_id),\n\n    -- status transitions (edit required keys as you like)\n    status = CASE\n      WHEN COALESCE($4, draft_image_file_id) IS NOT NULL THEN 'drafts_ready'::review_status\n      WHEN\n        COALESCE(NULLIF(title_seed, ''), $2) IS NOT NULL\n        AND (COALESCE(factpack, '{}'::jsonb) || COALESCE($3::jsonb, '{}'::jsonb)) ? 'description'\n        AND (COALESCE(factpack, '{}'::jsonb) || COALESCE($3::jsonb, '{}'::jsonb)) ? 'specs'\n        AND (COALESCE(factpack, '{}'::jsonb) || COALESCE($3::jsonb, '{}'::jsonb)) ? 'price'\n      THEN 'await_manual_image'::review_status\n      ELSE status\n    END,\n\n    updated_at = NOW()\n  WHERE id = (SELECT id FROM existing)\n  RETURNING id, status, title_seed, factpack, draft_image_file_id\n),\nins AS (\n  INSERT INTO public.review_items (user_chat_id, status, title_seed, factpack, draft_image_file_id)\n  SELECT\n    $1,\n    'intake'::review_status,\n    $2,\n    COALESCE($3::jsonb, '{}'::jsonb)\n      || CASE WHEN $2 IS NOT NULL THEN jsonb_build_object('latest_user_message', $2) ELSE '{}'::jsonb END,\n    $4\n  WHERE NOT EXISTS (SELECT 1 FROM existing)\n  RETURNING id, status, title_seed, factpack, draft_image_file_id\n)\nSELECT * FROM upd\nUNION ALL\nSELECT * FROM ins;\n",
        "options": {
          "queryReplacement": "={{ [\n  $json.message.chat.id,\n  ($json.message.text ?? null),\n  $fromAI('factpack_patch', '', 'string') || null,\n  (\n    $json.message.photo\n      ? $json.message.photo[$json.message.photo.length - 1].file_id\n      : ($json.message.document?.file_id ?? null)\n  )\n] }}"
        }
      },
      "type": "n8n-nodes-base.postgresTool",
      "typeVersion": 2.6,
      "position": [
        -3952,
        1408
      ],
      "id": "9f3ea44a-9e72-45f3-92b6-e6970ac5cde7",
      "name": "Execute a SQL query in Postgres",
      "credentials": {
        "postgres": {
          "id": "Apw2GZOwP2Hlrwwo",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "={{ $json.output }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -3824,
        1216
      ],
      "id": "28d330e9-b1f5-46a6-93ec-56a0ead7f3e2",
      "name": "Send a text message",
      "webhookId": "82563cbf-7c5c-4f39-8f74-f723ad30b6ed",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT title_seed, factpack, status, draft_image_file_id\nFROM public.review_items\nWHERE user_chat_id = $1\n  AND status IN ('intake', 'brief_ready', 'await_manual_image', 'drafts_ready')\nORDER BY created_at DESC\nLIMIT 1;",
        "options": {
          "queryReplacement": "={{ $('Telegram Trigger').item.json.message.chat.id }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -4720,
        1232
      ],
      "id": "437fbf4c-d80c-49e3-a93a-6583a6a0f308",
      "name": "Execute a SQL query",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "Apw2GZOwP2Hlrwwo",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT id, factpack, title_seed, draft_image_file_id \nFROM public.review_items \nWHERE user_chat_id = $1 \nAND status = 'drafts_ready' \nORDER BY updated_at DESC \nLIMIT 1;",
        "options": {
          "queryReplacement": "={{ $('Telegram Trigger').item.json.message.chat.id }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -3264,
        1200
      ],
      "id": "b21061ea-9cb9-4acb-b058-d5622454a108",
      "name": "Postgres (Get Factpack)",
      "credentials": {
        "postgres": {
          "id": "Apw2GZOwP2Hlrwwo",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -4448,
        1216
      ],
      "id": "469d46b1-375f-4265-ac0f-f274424b024b",
      "name": "Merge"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "={{ $('DB: Save Drafts').first().json.draft_announce }}",
        "additionalFields": {
          "appendAttribution": false,
          "parse_mode": "HTML"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -208,
        848
      ],
      "id": "14c0f3ab-8b60-4c0a-955b-49cbbe4822e1",
      "name": "TG: –ê–ø—Ä—É–≤-2 (–∞–Ω–æ–Ω—Å)",
      "webhookId": "aab7cb83-c65c-4149-9c5c-f8bc942d23bb",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const MAX_LEN = 3800;\n\n// –§—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏ HTML –¥–ª—è Telegram\nfunction cleanForTelegram(text) {\n  if (!text) return \"\";\n  return String(text)\n    .replace(/<br\\s*\\/?>/gi, '\\n')       // <br> -> –ø–µ—Ä–µ–Ω–æ—Å\n    .replace(/<\\/p>/gi, '\\n\\n')          // </p> -> –¥–≤–∞ –ø–µ—Ä–µ–Ω–æ—Å–∞\n    .replace(/<p[^>]*>/gi, '')           // <p> -> —É–¥–∞–ª–∏—Ç—å\n    .replace(/<\\/?(div|span)[^>]*>/gi, '') // div/span -> —É–¥–∞–ª–∏—Ç—å\n    .replace(/<ul>/gi, '')               // <ul> -> —É–¥–∞–ª–∏—Ç—å\n    .replace(/<\\/ul>/gi, '\\n')\n    .replace(/<li>/gi, '‚Ä¢ ')             // <li> -> –±—É–ª–ª–∏—Ç\n    .replace(/<\\/li>/gi, '\\n');\n}\n\nfunction splitByParagraphs(text, maxLen) {\n  const parts = [];\n  // –°–Ω–∞—á–∞–ª–∞ —á–∏—Å—Ç–∏–º —Ç–µ–∫—Å—Ç –æ—Ç –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö —Ç–µ–≥–æ–≤\n  const cleanText = cleanForTelegram(text);\n  \n  const paras = cleanText.split(/\\n\\s*\\n/);\n  let buf = \"\";\n\n  function pushBuf() {\n    const t = buf.trim();\n    if (t) parts.push(t);\n    buf = \"\";\n  }\n\n  for (const pRaw of paras) {\n    const p = pRaw.trim();\n    if (!p) continue;\n\n    if ((buf.length ? buf.length + 2 : 0) + p.length <= maxLen) {\n      buf = buf ? (buf + \"\\n\\n\" + p) : p;\n      continue;\n    }\n\n    pushBuf();\n\n    if (p.length <= maxLen) {\n      buf = p;\n      continue;\n    }\n\n    let s = p;\n    while (s.length > maxLen) {\n      parts.push(s.slice(0, maxLen));\n      s = s.slice(maxLen);\n    }\n    buf = s;\n  }\n\n  pushBuf();\n  return parts;\n}\n\n// --- –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –°–°–´–õ–û–ö ---\n// 1. –ë–µ—Ä–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–æ–¥—ã\nconst dbItem = $('DB: Save Drafts').first();\nconst llmItem = $('LLM: –õ–æ–Ω–≥—Ä–∏–¥').first();\n\n// 2. –î–æ—Å—Ç–∞–µ–º —Ç–µ–∫—Å—Ç (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É –±–∞–∑—ã)\nconst longread = (dbItem ? dbItem.json.draft_longread : null) || \n                 (llmItem ? llmItem.json.output : null) || \n                 \"\";\n// -------------------------\n\nconst chunks = splitByParagraphs(longread, MAX_LEN);\n\nif (chunks.length === 0) {\n    return [{ json: { text: \"–û—à–∏–±–∫–∞: –¢–µ–∫—Å—Ç –ª–æ–Ω–≥—Ä–∏–¥–∞ –ø—É—Å—Ç\" } }];\n}\n\nreturn chunks.map((t, i) => ({\n  json: {\n    text: (chunks.length > 1 ? `[${i + 1}/${chunks.length}]\\n\\n` : \"\") + t\n  }\n}));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        336,
        848
      ],
      "id": "b9927628-a0e0-4442-89cf-702a5018695a",
      "name": "–ö–æ–¥: –†–∞–∑–±–∏—Ç—å –ª–æ–Ω–≥—Ä–∏–¥ –¥–ª—è –¢–ì"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        624,
        848
      ],
      "id": "08a939e6-7eb4-42ff-a3a3-49e2afb3adbe",
      "name": "–¶–∏–∫–ª: –ß–∞—Å—Ç–∏ –ª–æ–Ω–≥—Ä–∏–¥–∞"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "={{ $json.text }}",
        "additionalFields": {
          "appendAttribution": false,
          "parse_mode": "HTML"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        992,
        864
      ],
      "id": "305b5a51-9010-4e00-840b-27a95792d3f2",
      "name": "TG: –ê–ø—Ä—É–≤-2 (–ª–æ–Ω–≥—Ä–∏–¥ —á–∞—Å—Ç—å)",
      "webhookId": "88689bdd-ddd8-4d67-a057-afcc0fcaac00",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE public.review_items\nSET approve2_text_message_id = $2\nWHERE id = $1\nRETURNING id AS review_id, approve2_text_message_id;",
        "options": {
          "queryReplacement": "={{ [ $('DB: Save Drafts').first().json.review_id, $json.result.message_id ] }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        32,
        848
      ],
      "id": "22eca055-7dd6-4280-b90b-794a106fcdcd",
      "name": "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ID –∞–Ω–æ–Ω—Å–∞",
      "credentials": {
        "postgres": {
          "id": "Apw2GZOwP2Hlrwwo",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE public.review_items\nSET\n  approve2_message_id = $2,\n  approve2_chat_id = $3\nWHERE id = $1;",
        "options": {
          "queryReplacement": "={{ [\n  $('DB: Save Drafts').first().json.review_id,\n  $json.result.message_id,\n  $json.result.chat.id\n] }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2,
      "position": [
        1056,
        592
      ],
      "id": "97bb400d-931c-42e4-a8ca-44eeda9e30e3",
      "name": "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å id –∫–Ω–æ–ø–æ–∫",
      "credentials": {
        "postgres": {
          "id": "Apw2GZOwP2Hlrwwo",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "WITH \nchats AS (\n  SELECT\n    MAX(chat_id) FILTER (WHERE purpose = 'rss_draft') AS rss_draft_chat_id,\n    MAX(chat_id) FILTER (WHERE purpose = 'approve_review')   AS approve_chat_id,\n    MAX(chat_id) FILTER (WHERE purpose = 'publish')   AS publish_chat_id\n  FROM public.telegram_chats\n  WHERE project_key = 'ainews'\n    AND is_active = true\n),\nprompts AS (\n  SELECT jsonb_object_agg(key, content) AS prompts\n  FROM public.system_prompts\n  WHERE key IN ('review_title', 'review_announce', 'review_longread', 'image_prompt')\n)\nSELECT * FROM chats, prompts;",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -3024,
        992
      ],
      "id": "2f9372f4-6a46-4f46-bc24-5a9d79b8afac",
      "name": "–ü–æ–ª—É—á–∏—Ç—å —á–∞—Ç—ã –∏ –ø—Ä–æ–º—Ç—ã",
      "credentials": {
        "postgres": {
          "id": "Apw2GZOwP2Hlrwwo",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=CONTEXT:\n{{ $json.output }}\n",
        "options": {
          "systemMessage": "={{ $('–ü–æ–ª—É—á–∏—Ç—å —á–∞—Ç—ã –∏ –ø—Ä–æ–º—Ç—ã').first().json.prompts.review_title }}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        -1904,
        1184
      ],
      "id": "39d197e2-38d9-4b42-8d80-6b7558be5237",
      "name": "–ó–∞–≥–æ–ª–æ–≤–æ–∫"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=LONGREAD_HTML:\n{{ $json.output }}\n",
        "options": {
          "systemMessage": "={{ $('–ü–æ–ª—É—á–∏—Ç—å —á–∞—Ç—ã –∏ –ø—Ä–æ–º—Ç—ã').first().json.prompts.review_announce }}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        -2224,
        1184
      ],
      "id": "3b053dac-eb90-4804-a0b5-28ee65426d90",
      "name": "LLM: –ê–Ω–æ–Ω—Å"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Title: {{ $('Postgres (Get Factpack)').item.json.title_seed }}\nFacts: {{ JSON.stringify($('Postgres (Get Factpack)').item.json.factpack) }}",
        "options": {
          "systemMessage": "={ $('–ü–æ–ª—É—á–∏—Ç—å —á–∞—Ç—ã –∏ –ø—Ä–æ–º—Ç—ã').first().json.prompts.review_longread }}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        -2576,
        1184
      ],
      "id": "33548445-0a75-4b08-b8d9-975bd123ace5",
      "name": "LLM: –õ–æ–Ω–≥—Ä–∏–¥"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE public.review_items \nSET \n  draft_title = $1, \n  draft_longread = $2, \n  draft_announce = $3, \n  status = 'needs_review', \n  updated_at = NOW() \nWHERE id = $4 \nRETURNING id AS review_id, draft_image_file_id, draft_announce, draft_title;",
        "options": {
          "queryReplacement": "={{ [\n  $('–ó–∞–≥–æ–ª–æ–≤–æ–∫').first().json.output,      // $1 - –ó–∞–≥–æ–ª–æ–≤–æ–∫\n  $('LLM: –õ–æ–Ω–≥—Ä–∏–¥').first().json.output,   // $2 - –õ–æ–Ω–≥—Ä–∏–¥\n  $('LLM: –ê–Ω–æ–Ω—Å').first().json.output,     // $3 - –ê–Ω–æ–Ω—Å\n  $('Postgres (Get Factpack)').first().json.id // $4 - ID (–±–µ—Ä–µ–º –∏–∑ –Ω–∞—á–∞–ª–∞ –≤–µ—Ç–∫–∏)\n] }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -1232,
        848
      ],
      "id": "f7869d36-4d4c-4c81-aa25-534736ca7941",
      "name": "DB: Save Drafts",
      "credentials": {
        "postgres": {
          "id": "Apw2GZOwP2Hlrwwo",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "numberInputs": 3,
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -1488,
        832
      ],
      "id": "0a94f61a-e1dd-4f8f-b849-36c4a396f5f8",
      "name": "Merge2"
    },
    {
      "parameters": {
        "operation": "get",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "status",
              "keyValue": "intake"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        -4080,
        1408
      ],
      "id": "c1051575-47b9-4e67-bbe0-36729bb52596",
      "name": "–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -2816,
        1184
      ],
      "id": "d5aa180f-687f-48a6-b114-4b2012d42c5c",
      "name": "–°–æ–µ–¥–∏–Ω–∏—Ç—å"
    },
    {
      "parameters": {
        "operation": "sendPhoto",
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "file": "={{ $json.draft_image_file_id }}",
        "additionalFields": {
          "caption": "={{ $json.draft_title }}"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -784,
        368
      ],
      "id": "9abb63ff-79b9-492b-a35a-eef6a7ac2c6d",
      "name": "TG: –ê–ø—Ä—É–≤-2 (—Ñ–æ—Ç–æ)",
      "webhookId": "0a567f92-1cda-4ab8-affd-8cf9ba927238",
      "retryOnFail": true,
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT id, rewrite2_state, status \nFROM public.review_items \nWHERE user_chat_id = $1 \n  AND (\n    rewrite2_state LIKE 'awaiting%' \n    OR \n    status = 'needs_review'\n  )\nORDER BY updated_at DESC\nLIMIT 1;",
        "options": {
          "queryReplacement": "={{ $json.message?.chat?.id || $json.callback_query?.message?.chat?.id }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -5600,
        1040
      ],
      "id": "25456e82-dc65-42b7-badf-9febf95c23dd",
      "name": "–ë–î: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∞–≤–∫–∏",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "Apw2GZOwP2Hlrwwo",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger').item.json.callback_query?.id }}",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "notEmpty",
                      "singleValue": true
                    },
                    "id": "72ff55ca-fef9-416e-9c25-3ca30b211941"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–ö–Ω–æ–ø–∫–∞ (Callback)"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.rewrite2_state }}",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "notEmpty"
                    },
                    "id": "ecb53a8f-1fc2-4f93-b31b-f8070171005c"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–¢–µ–∫—Å—Ç (–ü—Ä–∞–≤–∫–∞)"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Telegram Trigger').item.json.message?.message_id }}",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "notEmpty",
                      "singleValue": true
                    },
                    "id": "a24d2414-c3ae-4097-b1b5-f37152eafd97"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–ù–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç (Intake)"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "loose",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "b1855861-fb12-4dbb-a1fa-788f453ef22e",
                    "leftValue": "={{ $json.status }}",
                    "rightValue": "=needs_review",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–£–∂–µ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π –æ–±–∑–æ—Ä"
            }
          ]
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        -5120,
        1184
      ],
      "id": "98770c21-631f-4791-a073-cc2ae48f04bd",
      "name": "–†–æ—É—Ç–µ—Ä: –ö–Ω–æ–ø–∫–∞ –∏–ª–∏ –¢–µ–∫—Å—Ç?"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT\n  MAX(chat_id) FILTER (WHERE purpose = 'rss_draft') AS rss_draft_chat_id,\n  MAX(chat_id) FILTER (WHERE purpose = 'approve_review')   AS approve_chat_id,\n  MAX(chat_id) FILTER (WHERE purpose = 'publish')   AS publish_chat_id\nFROM public.telegram_chats\nWHERE project_key = 'ainews'\n  AND is_active = true;\n",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 1,
      "position": [
        -4880,
        2624
      ],
      "id": "4fc33406-b441-4ad7-ace0-acf520862a81",
      "name": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤",
      "credentials": {
        "postgres": {
          "id": "Apw2GZOwP2Hlrwwo",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Normalization for Telegram updates (callback_query + message)\n// Works even if trigger node name differs (Telegram Trigger / –¢—Ä–∏–≥–≥–µ—Ä Telegram)\n\nfunction pickTriggerItem() {\n  // Try by exact node names (most stable in complex flows)\n  try {\n    const a = $items(\"–¢—Ä–∏–≥–≥–µ—Ä Telegram\");\n    if (a && a[0]) return a[0];\n  } catch (e) {}\n\n  try {\n    const b = $items(\"Telegram Trigger\");\n    if (b && b[0]) return b[0];\n  } catch (e) {}\n\n  // Fallback: sometimes the trigger payload is already in $json\n  const inItem = $input.first();\n  if (inItem && inItem.json) return inItem;\n\n  throw new Error(\"Telegram trigger item not found. Rename trigger node or execute workflow from trigger.\");\n}\n\nfunction unwrapTelegramPayload(j) {\n  // Different n8n/telegram nodes may wrap payload differently\n  // Prefer explicit wrappers, else return as-is\n  if (j && typeof j === \"object\") {\n    if (j.body && typeof j.body === \"object\") return j.body;\n    if (j.update && typeof j.update === \"object\") return j.update;\n  }\n  return j;\n}\n\nconst tgItem = pickTriggerItem();\nconst raw = tgItem.json || {};\nconst body = unwrapTelegramPayload(raw);\n\n// 1) CALLBACK HANDLING\nif (body && body.callback_query) {\n  const cq = body.callback_query;\n  const data = String(cq.data || cq.callback_data || \"\");\n  const parts = data.split(\"|\");\n\n  // Normalization: remove prefixes to match Switch node logic (A2, R2, etc.)\n  let rawAction = (parts[0] || \"\").trim();\n  const action = rawAction.replace(\"REVIEW_\", \"\").replace(\"NEWS_\", \"\");\n\n  const newsId = (parts[1] || \"\").trim();\n  const target = (parts[2] || \"\").trim();\n\n  const msg = cq.message || null;\n  const chatId = msg && msg.chat ? msg.chat.id : null;\n  const messageId = msg ? msg.message_id : null;\n  const messageText = msg ? String(msg.text || msg.caption || \"\") : \"\";\n\n  return [{\n    json: {\n      type: \"callback\",\n      action: action,\n      router_action: action,\n      router_data: data,\n\n      news_id: newsId,\n      review_id: newsId, // Compatibility with existing flow\n      target: target || null,\n\n      query_id: cq.id || null,\n      from_id: cq.from ? cq.from.id : null,\n      chat_id: chatId,\n      message_id: messageId,\n      message_text: messageText\n    }\n  }];\n}\n\n// 2) MESSAGE HANDLING (text/voice/reply)\nif (body && body.message) {\n  const m = body.message;\n\n  return [{\n    json: {\n      type: \"message\",\n      from_id: m.from ? m.from.id : null,\n      chat_id: m.chat ? m.chat.id : null,\n      message_id: m.message_id || null,\n      text: String(m.text || \"\"),\n\n      voice_file_id: m.voice ? m.voice.file_id : null,\n      reply_to_message_id: (m.reply_to_message && m.reply_to_message.message_id) ? m.reply_to_message.message_id : null\n    }\n  }];\n}\n\nreturn [{\n  json: {\n    type: \"unknown\",\n    debug_input: body\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 1,
      "position": [
        -4656,
        2624
      ],
      "id": "6c28d3c0-e37d-41f8-9b0d-70d550ca9d1b",
      "name": "–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞"
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.type }}",
              "value2": "callback"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        -4432,
        2624
      ],
      "id": "2c2c29e4-7aae-4f4d-9fde-25cce3636a96",
      "name": "–ï—Å–ª–∏: –≠—Ç–æ –∫–Ω–æ–ø–∫–∞?"
    },
    {
      "parameters": {
        "resource": "callback",
        "queryId": "={{ $json.query_id }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -4208,
        2480
      ],
      "id": "4093243b-564d-4ccc-bcae-5615f417da6f",
      "name": "TG: Answer Callback",
      "webhookId": "f116e3ac-79a4-4018-9c5f-e9ab6b5b3b4b",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "A1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "6861ac48-1d95-42ab-8187-5c97cfd2223a"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "A2 (–û–¥–æ–±—Ä–∏—Ç—å)"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "R2",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "557116ab-5d37-4175-bf35-3fa7b3eff3df"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "R2 (–ü—Ä–∞–≤–∫–∏)"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "X2",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "6d2f3549-f14b-44f3-a8cc-c60e7410545a"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "X2 (–°–∫–∏–ø)"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "Edit",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "e4223388-caca-4d60-9497-a392620a24e1"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–í—ã–±–æ—Ä —Ç–∏–ø–∞ –ø—Ä–∞–≤–∫–∏"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "CancelEdit",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "36231a10-d5fc-4f72-8087-50141f64fec5"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–û—Ç–º–µ–Ω–∞"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "PubNow",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "6b1020bc-1346-44ef-99b8-facf93e1f0f9"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–ü—É–±–ª–∏–∫–∞—Ü–∏—è: –°–µ–π—á–∞—Å"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "PubLater",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "1737a162-f3d1-4bb6-a511-d1b060909d4e"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–ü—É–±–ª–∏–∫–∞—Ü–∏—è: –ü–æ—Ç–æ–º"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        -3936,
        2400
      ],
      "id": "362f2287-ca8d-4224-afed-cfda3c871197",
      "name": "Switch: –î–µ–π—Å—Ç–≤–∏–µ"
    },
    {
      "parameters": {
        "operation": "editMessageText",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.message_id }}",
        "replyMarkup": "inlineKeyboard",
        "text": "‚è∞ –ö–æ–≥–¥–∞ –ø—É–±–ª–∏–∫—É–µ–º –æ–±–∑–æ—Ä?",
        "inlineKeyboard": {
          "rows": [
            {
              "row": {
                "buttons": [
                  {
                    "text": "üöÄ –ü—Ä—è–º–æ —Å–µ–π—á–∞—Å",
                    "additionalFields": {
                      "callback_data": "={{ 'PubNow|' + $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').first().json.review_id }}"
                    }
                  },
                  {
                    "text": "üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å",
                    "additionalFields": {
                      "callback_data": "={{ 'PubLater|' + $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').first().json.review_id }}"
                    }
                  }
                ]
              }
            },
            {
              "row": {
                "buttons": [
                  {
                    "text": "üîô –ù–∞–∑–∞–¥",
                    "additionalFields": {
                      "callback_data": "={{ 'CancelEdit|' + $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.review_id }}"
                    }
                  }
                ]
              }
            }
          ]
        },
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -3568,
        1920
      ],
      "id": "2efd5339-664e-4c48-80e0-6bb966773665",
      "name": "TG: –í—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏",
      "webhookId": "778376b4-6155-4ee8-a381-4fdd212cee5c",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "operation": "editMessageText",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.message_id }}",
        "replyMarkup": "inlineKeyboard",
        "text": "üëá –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –±—É–¥–µ–º –ø—Ä–∞–≤–∏—Ç—å?",
        "inlineKeyboard": {
          "rows": [
            {
              "row": {
                "buttons": [
                  {
                    "text": "üì¢ –ê–Ω–æ–Ω—Å",
                    "additionalFields": {
                      "callback_data": "={{ 'Edit|' + $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.review_id + '|announce' }}"
                    }
                  },
                  {
                    "text": "üìú –õ–æ–Ω–≥—Ä–∏–¥",
                    "additionalFields": {
                      "callback_data": "={{ 'Edit|' + $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.review_id + '|longread' }}"
                    }
                  },
                  {
                    "text": "üñº –ö–∞—Ä—Ç–∏–Ω–∫–∞",
                    "additionalFields": {
                      "callback_data": "={{ 'Edit|' + $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.review_id + '|image' }}"
                    }
                  }
                ]
              }
            },
            {
              "row": {
                "buttons": [
                  {
                    "text": "üîô –û—Ç–º–µ–Ω–∞ (–ø–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é)",
                    "additionalFields": {
                      "callback_data": "={{ 'CancelEdit|' + $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.review_id }}"
                    }
                  }
                ]
              }
            }
          ]
        },
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -3296,
        2112
      ],
      "id": "520922e6-029a-42a5-9557-e8ad3e86acf2",
      "name": "TG: –ú–µ–Ω—é –ø—Ä–∞–≤–æ–∫",
      "webhookId": "071824ba-ea8a-4c41-afd6-ea388076da1f",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "operation": "editMessageText",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.message_id }}",
        "text": "üóë –û–±–∑–æ—Ä –≤ –∫–æ—Ä–∑–∏–Ω–µ",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -3616,
        2368
      ],
      "id": "dde96e5a-f7bb-4cb2-bb77-78413f32ce3e",
      "name": "TG: –£–¥–∞–ª–∏—Ç—å –∫–Ω–æ–ø–∫–∏ (X2)",
      "webhookId": "fc8ea779-088d-436b-96f1-ebdbd9f11b43",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "text": "={{ '‚úèÔ∏è –í—ã–±—Ä–∞–Ω–æ: ' + ($('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.target === 'announce' ? '–ê–Ω–æ–Ω—Å' : ($('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.target === 'longread' ? '–õ–æ–Ω–≥—Ä–∏–¥' : ($('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.target === 'image' ? '–ö–∞—Ä—Ç–∏–Ω–∫–∞' : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ (' + $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.target + ')'))) + '\\n\\n–ù–∞–ø–∏—à–∏ (–∏–ª–∏ —Å–∫–∞–∂–∏), —á—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å?' }}",
        "replyMarkup": "forceReply",
        "forceReply": {},
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -3632,
        2544
      ],
      "id": "57658e8a-e6b7-4721-9adc-7c7e050129cd",
      "name": "TG: –ó–∞–ø—Ä–æ—Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏",
      "webhookId": "bf11dc16-5a69-4262-8ff6-f139a142c03e",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "operation": "editMessageText",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.message_id }}",
        "replyMarkup": "inlineKeyboard",
        "text": "=–ü—É–±–ª–∏–∫—É–µ–º?",
        "inlineKeyboard": {
          "rows": [
            {
              "row": {
                "buttons": [
                  {
                    "text": "‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è",
                    "additionalFields": {
                      "callback_data": "={{ 'A2|' + $json.id }}"
                    }
                  },
                  {
                    "text": "‚úçÔ∏è –ü—Ä–∞–≤–∫–∏",
                    "additionalFields": {
                      "callback_data": "={{ 'R2|' + $json.review_id }}"
                    }
                  },
                  {
                    "text": "üóëÔ∏è –°–∫–∏–ø",
                    "additionalFields": {
                      "callback_data": "={{ 'X2|' + $json.review_id }}"
                    }
                  }
                ]
              }
            }
          ]
        },
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -3408,
        2736
      ],
      "id": "225cb606-11c5-4078-8dfc-72eb2d1e729d",
      "name": "TG: –í–µ—Ä–Ω—É—Ç—å –º–µ–Ω—é",
      "webhookId": "ed7f3341-259d-4a17-9306-1982a0e65b6d",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "text": "üöÄ –û–±–∑–æ—Ä –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ –æ—á–µ—Ä–µ–¥—å (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ). –ñ–¥–∏—Ç–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -2480,
        2976
      ],
      "id": "6127fba8-42e2-4df0-90f8-91993c32868a",
      "name": "TG: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (Now)",
      "webhookId": "067f1c81-7814-4638-951a-6a625581c701",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "text": "üìÖ –ù–∞–ø–∏—à–∏ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.\n–ü—Ä–∏–º–µ—Ä: \"–∑–∞–≤—Ç—Ä–∞ –≤ 10:00\" –∏–ª–∏ \"—á–µ—Ä–µ–∑ 2 —á–∞—Å–∞\".",
        "replyMarkup": "forceReply",
        "forceReply": {},
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -3616,
        3168
      ],
      "id": "a47d53b7-cb91-455d-bd91-cba13b8c4ac9",
      "name": "TG: –°–ø—Ä–æ—Å–∏—Ç—å –¥–∞—Ç—É",
      "webhookId": "2139404f-ef40-4c7d-b1b4-e3a719a3ec3c",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.voice_file_id }}",
              "operation": "isNotEmpty"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        -4256,
        3712
      ],
      "id": "03793fb3-4552-4406-bb3a-0125a0478007",
      "name": "–ï—Å–ª–∏: –≠—Ç–æ –≥–æ–ª–æ—Å?"
    },
    {
      "parameters": {
        "resource": "file",
        "fileId": "={{ $json.voice_file_id }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -4032,
        3536
      ],
      "id": "dd2a3c52-7780-4971-922c-6c9fff721e74",
      "name": "TG: –°–∫–∞—á–∞—Ç—å –∞—É–¥–∏–æ",
      "webhookId": "65213544-abe0-497a-b38c-06d2820b0a59",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "options": {
          "language": "ru"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1,
      "position": [
        -3776,
        3536
      ],
      "id": "4bce1be1-1651-4ad6-b795-033eed44b54c",
      "name": "OpenAI: –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è",
      "credentials": {
        "openAiApi": {
          "id": "U1pcqbZS37eHdBPO",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.rewrite2_state }}",
                    "rightValue": "awaiting_announce",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–ê–Ω–æ–Ω—Å"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.rewrite2_state }}",
                    "rightValue": "awaiting_longread",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–õ–æ–Ω–≥—Ä–∏–¥"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.rewrite2_state }}",
                    "rightValue": "awaiting_image",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–ö–∞—Ä—Ç–∏–Ω–∫–∞"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.rewrite2_state }}",
                    "rightValue": "awaiting_pub_date",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        -2864,
        3696
      ],
      "id": "f9e858cf-3448-4930-b619-18861a66b17e",
      "name": "–ß—Ç–æ –ø—Ä–∞–≤–∏–º?"
    },
    {
      "parameters": {
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "text": "={{ 'üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞: ' +\n  new Date($items('–ö–æ–¥: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Jobs1')[$itemIndex].json.publish_at)\n    .toLocaleString('ru-RU', {\n      timeZone: 'Europe/Moscow',\n      year: 'numeric',\n      month: '2-digit',\n      day: '2-digit',\n      hour: '2-digit',\n      minute: '2-digit'\n    })\n}}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1360,
        4560
      ],
      "id": "f98182a9-af37-4b57-8103-53cb364df27a",
      "name": "TG: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (–ü–ª–∞–Ω)",
      "webhookId": "39e626a0-5678-43c6-a37c-b05da7b73f9b",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "operation": "get",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "keyValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.review_id }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -3632,
        2736
      ],
      "id": "73a533bc-81a4-4206-ad2a-2c969254287e",
      "name": "–ë–î: –î–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "tableId": "review_items",
        "limit": 1,
        "filters": {
          "conditions": [
            {
              "keyName": "rewrite2_state",
              "condition": "like",
              "keyValue": "awaiting%"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -3152,
        3728
      ],
      "id": "3559fe16-69bc-4692-a231-63f35cb56f0a",
      "name": "–ë–î: –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É—é –ø—Ä–∞–≤–∫—É",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "condition": "eq",
              "keyValue": "={{ $('–ë–î: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∞–≤–∫–∏').item.json.id }}"
            }
          ]
        },
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "rewrite2_state",
              "fieldValue": "selecting"
            },
            {
              "fieldId": "rewrite2_requester_id",
              "fieldValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.from_id }}"
            },
            {
              "fieldId": "rewrite2_requested_at",
              "fieldValue": "={{ $now }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -3520,
        2112
      ],
      "id": "c7abaa85-9a2e-4ea3-b2e1-ef7095bb2dec",
      "name": "–ë–î: –°—Ç–∞—Ä—Ç –ø—Ä–∞–≤–∫–∏ (R2)",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "condition": "eq",
              "keyValue": "={{ $('–ë–î: –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É—é –ø—Ä–∞–≤–∫—É').item.json.id }}"
            }
          ]
        },
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "draft_longread",
              "fieldValue": "={{ $json.output }}"
            },
            {
              "fieldId": "rewrite2_state",
              "fieldValue": "={{ null }}"
            },
            {
              "fieldId": "drafts_updated_at",
              "fieldValue": "={{ $now }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -2176,
        3648
      ],
      "id": "d524a16c-f0a7-4d1a-8566-d874446a4d80",
      "name": "–ë–î: –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–Ω–≥—Ä–∏–¥",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "condition": "eq",
              "keyValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.review_id }}"
            }
          ]
        },
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "rewrite2_state",
              "fieldValue": "awaiting_pub_date"
            },
            {
              "fieldId": "rewrite2_request_message_id",
              "fieldValue": "={{ $json.result.message_id }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -3424,
        3168
      ],
      "id": "4d97566f-22f5-4710-955e-9cd8c35b401d",
      "name": "–ë–î: –ñ–¥–µ–º –¥–∞—Ç—É",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "condition": "eq",
              "keyValue": "={{ $('–ë–î: –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É—é –ø—Ä–∞–≤–∫—É').item.json.id }}"
            }
          ]
        },
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "draft_image_prompt",
              "fieldValue": "={{ $('AI: –ü—Ä–æ–º—Ç –¥–ª—è DALL-E').item.json.output }}"
            },
            {
              "fieldId": "draft_image_file_id",
              "fieldValue": "={{ $json.result.photo[3].file_id }}"
            },
            {
              "fieldId": "drafts_updated_at",
              "fieldValue": "={{ $now }}"
            },
            {
              "fieldId": "rewrite2_state",
              "fieldValue": "={{ null }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -1040,
        4112
      ],
      "id": "c8656a67-878d-4077-8c57-7705b04d24a4",
      "name": "–ë–î: –û–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "operation": "deleteMessage",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.message_id }}"
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -2752,
        2976
      ],
      "id": "df71e8dc-b365-4e32-afb2-b89048db7f6e",
      "name": "TG: –£–¥–∞–ª–∏—Ç—å –º–µ–Ω—é –≤—Ä–µ–º–µ–Ω–∏",
      "webhookId": "5661c516-167a-4dc9-9b6d-cbb31be16d42",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "condition": "eq",
              "keyValue": "={{ $('–ë–î: –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É—é –ø—Ä–∞–≤–∫—É').item.json.id }}"
            }
          ]
        },
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "draft_announce",
              "fieldValue": "={{ $json.output }}"
            },
            {
              "fieldId": "rewrite2_state",
              "fieldValue": "={{ null }}"
            },
            {
              "fieldId": "drafts_updated_at",
              "fieldValue": "={{ $now }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -2224,
        3296
      ],
      "id": "02193001-1114-4eb5-8ef8-7a973231a6e4",
      "name": "–ë–î: –û–±–Ω–æ–≤–∏—Ç—å –∞–Ω–æ–Ω—Å",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "text-set",
              "name": "text",
              "value": "={{ $json.text }}",
              "type": "string"
            },
            {
              "id": "reply-set",
              "name": "reply_to_message_id",
              "value": "={{ $('Telegram Trigger').item.json.message.reply_to_message.message_id }}",
              "type": "string"
            },
            {
              "id": "chat-set",
              "name": "chat_id",
              "value": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
              "type": "string"
            },
            {
              "id": "from-set",
              "name": "from_id",
              "value": "={{ $('Telegram Trigger').item.json.message.from.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3456,
        3728
      ],
      "id": "dcbbff70-28d2-41cd-9711-ee3ccc42eac7",
      "name": "–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç"
    },
    {
      "parameters": {
        "operation": "get",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "keyValue": "={{ $('–ë–î: –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É—é –ø—Ä–∞–≤–∫—É').item.json.id }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -1952,
        3296
      ],
      "id": "88fc3dfe-382f-4eb8-8c83-83f354e44d7f",
      "name": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "operation": "deleteMessage",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.message_id }}"
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1728,
        3296
      ],
      "id": "d0b6bd6e-e484-4ff3-b3db-02496d050591",
      "name": "TG: –£–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç —é–∑–µ—Ä–∞",
      "webhookId": "20292647-c666-42b4-9861-a3d764e67bf7",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "deleteMessage",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ').item.json.rewrite2_question_message_id }}"
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1520,
        3296
      ],
      "id": "3700dddc-324b-4251-890a-a4f9805d0d74",
      "name": "TG: –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å –±–æ—Ç–∞",
      "webhookId": "00cd84ae-bd3b-4485-8fbb-efdbb3c5c568",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "condition": "eq",
              "keyValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.review_id }}"
            }
          ]
        },
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "rewrite2_state",
              "fieldValue": "={{ 'awaiting_' + $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.target }}"
            },
            {
              "fieldId": "rewrite2_request_message_id",
              "fieldValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.message_id }}"
            },
            {
              "fieldId": "rewrite2_question_message_id",
              "fieldValue": "={{ $('TG: –ó–∞–ø—Ä–æ—Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏').item.json.result.message_id }}"
            },
            {
              "fieldId": "rewrite2_requester_id",
              "fieldValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.from_id }}"
            },
            {
              "fieldId": "rewrite2_chat_id",
              "fieldValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.chat_id }}"
            },
            {
              "fieldId": "rewrite2_requested_at",
              "fieldValue": "={{ $now }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -3408,
        2544
      ],
      "id": "f440235e-1b00-4760-bdea-443a9934bace",
      "name": "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ü–µ–ª—å –ø—Ä–∞–≤–∫–∏",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "operation": "editMessageText",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ').first().json.approve2_text_message_id }}",
        "text": "=‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: \n\n{{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ').item.json.draft_announce }}",
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1280,
        3120
      ],
      "id": "ce4f12df-99d6-40fd-85ef-8244581f76dc",
      "name": "–û–±–Ω–æ–≤–∏—Ç—å –∞–Ω–æ–Ω—Å",
      "webhookId": "7a099cfe-b97f-4d20-b997-245848763007",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "operation": "get",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "keyValue": "={{ $('–ë–î: –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É—é –ø—Ä–∞–≤–∫—É').item.json.id }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -1968,
        3648
      ],
      "id": "b23f5643-4cd8-4281-bfc8-37f415cee76f",
      "name": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "operation": "deleteMessage",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.message_id }}"
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1744,
        3648
      ],
      "id": "022d111d-d61a-4194-88e7-8df687524912",
      "name": "TG: –£–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç —é–∑–µ—Ä–∞1",
      "webhookId": "20292647-c666-42b4-9861-a3d764e67bf7",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "deleteMessage",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1').item.json.rewrite2_question_message_id }}"
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1488,
        3648
      ],
      "id": "ef91a35c-acb3-4db8-beeb-0a902f6b978a",
      "name": "TG: –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å –±–æ—Ç–∞1",
      "webhookId": "00cd84ae-bd3b-4485-8fbb-efdbb3c5c568",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "editMessageText",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ').item.json.approve2_message_id }}",
        "replyMarkup": "inlineKeyboard",
        "text": "=‚úÖ –ê–Ω–æ–Ω—Å –æ–±–Ω–æ–≤–ª–µ–Ω. –ü—É–±–ª–∏–∫—É–µ–º –æ–±–∑–æ—Ä?",
        "inlineKeyboard": {
          "rows": [
            {
              "row": {
                "buttons": [
                  {
                    "text": "‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è",
                    "additionalFields": {
                      "callback_data": "={{ 'A2|' + $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ').item.json.id }}"
                    }
                  },
                  {
                    "text": "‚úçÔ∏è –ü—Ä–∞–≤–∫–∏",
                    "additionalFields": {
                      "callback_data": "={{ 'R2|' + $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ').item.json.id }}"
                    }
                  },
                  {
                    "text": "üóëÔ∏è –°–∫–∏–ø",
                    "additionalFields": {
                      "callback_data": "={{ 'X2|' + $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ').item.json.id }}"
                    }
                  }
                ]
              }
            }
          ]
        },
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1280,
        3424
      ],
      "id": "07cccd2a-ee6f-493c-bbcf-ff5a88753c12",
      "name": "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ + –∫–Ω–æ–ø–∫–∏",
      "webhookId": "7a099cfe-b97f-4d20-b997-245848763007",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// 1. –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ\nconst item = $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1').first();\n// –ë–µ—Ä–µ–º —Ç–µ–∫—Å—Ç –¥—Ä–∞—Ñ—Ç–∞\nconst text = item.json.draft_longread || item.json.longread || \"\";\n// –ë–µ—Ä–µ–º —Å–ø–∏—Å–æ–∫ —Å—Ç–∞—Ä—ã—Ö ID (–µ—Å–ª–∏ –µ—Å—Ç—å)\nconst oldIds = item.json.approve2_longread_msg_ids || [];\n// –ë–µ—Ä–µ–º ID —Å—Ç–∞—Ä–æ–≥–æ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏\nconst oldButtonMsgId = item.json.approve2_message_id;\n\n// 3. –§—É–Ω–∫—Ü–∏—è —Ä–∞–∑–±–∏–≤–∫–∏ –Ω–∞ —á–∞–Ω–∫–∏ (3800 —Å–∏–º–≤–æ–ª–æ–≤ —Å –∑–∞–ø–∞—Å–æ–º)\nfunction splitSmart(str, max) {\n  const res = [];\n  const parts = str.split(/\\n\\s*\\n/);\n  let buf = \"\";\n  for (const p of parts) {\n    if ((buf.length + p.length + 2) > max) { res.push(buf.trim()); buf = \"\"; }\n    buf = buf ? buf + \"\\n\\n\" + p : p;\n  }\n  if (buf) res.push(buf.trim());\n  return res.length ? res : [str];\n}\n\nconst chunks = splitSmart(text, 3800);\n\n// –õ–û–ì–ò–ö–ê –†–ï–®–ï–ù–ò–Ø:\n// –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º (Edit) –¢–û–õ–¨–ö–û –µ—Å–ª–∏:\n// 1. –°—Ç–∞—Ä–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±—ã–ª–æ —Ä–æ–≤–Ω–æ –æ–¥–Ω–æ.\n// 2. –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Ç–æ–∂–µ –≤–ª–µ–∑–∞–µ—Ç –≤ –æ–¥–∏–Ω —á–∞–Ω–∫.\nconst canEdit = (oldIds.length === 1) && (chunks.length === 1);\n\nreturn {\n  json: {\n    can_edit: canEdit,\n    target_msg_id: oldIds[0],      // –î–ª—è –≤–µ—Ç–∫–∏ Edit\n    old_ids: oldIds,               // –ú–∞—Å—Å–∏–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤ –≤–µ—Ç–∫–µ Rebuild\n    old_btn_id: oldButtonMsgId,    // –°—Ç–∞—Ä–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è\n    chunks: chunks                 // –ù–æ–≤—ã–µ –∫—É—Å–∫–∏ —Ç–µ–∫—Å—Ç–∞\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -848,
        3648
      ],
      "id": "60bfb169-84d5-4f1f-82da-9f4da760dcdf",
      "name": "–ö–æ–¥: –ê–Ω–∞–ª–∏–∑ (Edit –∏–ª–∏ Rebuild?)"
    },
    {
      "parameters": {
        "operation": "get",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "keyValue": "={{ $('–ë–î: –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É—é –ø—Ä–∞–≤–∫—É').item.json.id }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -1680,
        4112
      ],
      "id": "53e283b3-9fdc-4b2e-a9b6-46e414a00e35",
      "name": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ2",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "operation": "editMessageText",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ2').item.json.approve2_message_id }}",
        "replyMarkup": "inlineKeyboard",
        "text": "=‚úÖ –ö–∞—Ä—Ç–∏–Ω–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞. –ü—É–±–ª–∏–∫—É–µ–º?",
        "inlineKeyboard": {
          "rows": [
            {
              "row": {
                "buttons": [
                  {
                    "text": "‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è",
                    "additionalFields": {
                      "callback_data": "={{ 'A2|' + $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ2').item.json.id }}"
                    }
                  },
                  {
                    "text": "‚úçÔ∏è –ü—Ä–∞–≤–∫–∏",
                    "additionalFields": {
                      "callback_data": "={{ 'R2|' + $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ2').item.json.id }}"
                    }
                  },
                  {
                    "text": "üóëÔ∏è –°–∫–∏–ø",
                    "additionalFields": {
                      "callback_data": "={{ 'X2|' + $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ2').item.json.id }}"
                    }
                  }
                ]
              }
            }
          ]
        },
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -816,
        4112
      ],
      "id": "7f1a07cb-2864-43bb-8905-678f05a85d8d",
      "name": "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ + –∫–Ω–æ–ø–∫–∏1",
      "webhookId": "7a099cfe-b97f-4d20-b997-245848763007",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "operation": "deleteMessage",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.message_id }}"
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1424,
        3904
      ],
      "id": "301e7575-78aa-4c4c-838e-c1e31bc0de6d",
      "name": "TG: –£–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç —é–∑–µ—Ä–∞2",
      "webhookId": "20292647-c666-42b4-9861-a3d764e67bf7",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "deleteMessage",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ2').item.json.rewrite2_question_message_id }}"
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -1424,
        4304
      ],
      "id": "933bcbdc-ff83-477b-b904-f6ae7099ea01",
      "name": "TG: –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å –±–æ—Ç–∞2",
      "webhookId": "00cd84ae-bd3b-4485-8fbb-efdbb3c5c568",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "get",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "keyValue": "={{ $('–ë–î: –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É—é –ø—Ä–∞–≤–∫—É').first().json.id }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -1120,
        4560
      ],
      "id": "de36ef60-c100-4f82-ba07-ec4339e71ab3",
      "name": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ3",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "operation": "deleteMessage",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.message_id }}"
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -752,
        4464
      ],
      "id": "73ce60a8-2b45-45d2-b4e3-45cd42954af2",
      "name": "TG: –£–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç —é–∑–µ—Ä–∞3",
      "webhookId": "20292647-c666-42b4-9861-a3d764e67bf7",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "deleteMessage",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $json.rewrite2_request_message_id }}"
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -736,
        4656
      ],
      "id": "01e7bd2a-8318-4e2e-9ecc-984d0ae8d8c7",
      "name": "TG: –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å –±–æ—Ç–∞3",
      "webhookId": "00cd84ae-bd3b-4485-8fbb-efdbb3c5c568",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "deleteMessage",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $json.approve2_message_id }}"
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -752,
        4848
      ],
      "id": "62099c72-b18e-4cf6-903f-a64dff0eec52",
      "name": "TG: –£–¥–∞–ª–∏—Ç—å –º–µ–Ω—é –≤—Ä–µ–º–µ–Ω–∏1",
      "webhookId": "5661c516-167a-4dc9-9b6d-cbb31be16d42",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "getAll",
        "tableId": "publish_recipes",
        "filters": {
          "conditions": [
            {
              "keyName": "is_active",
              "condition": "eq",
              "keyValue": "true"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -3616,
        2976
      ],
      "id": "b4f5c913-9b83-4856-9564-4a2bd9ebe217",
      "name": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å –†–µ—Ü–µ–ø—Ç—ã",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// 1. –ë–µ—Ä–µ–º —Ä–µ—Ü–µ–ø—Ç—ã (–≤—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ)\nconst recipes = $input.all().map(r => r.json);\n\n// 2. –ò–©–ï–ú ID –ù–û–í–û–°–¢–ò (–£–º–Ω—ã–π –ø–æ–∏—Å–∫)\nlet reviewId;\n\ntry {\n  // –ü–æ–ø—ã—Ç–∫–∞ 1: –í–∑—è—Ç—å –∏–∑ –Ω–∞—á–∞–ª–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è (–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –¥–ª—è –±–æ–µ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞)\n  // .first() –±–µ—Ä–µ—Ç –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç, –¥–∞–∂–µ –µ—Å–ª–∏ –∏—Ö —Ç–∞–º –º–Ω–æ–≥–æ\n  const normItem = $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').first();\n  if (normItem && normItem.json && normItem.json.review_id) {\n     reviewId = normItem.json.review_id;\n  }\n} catch (error) {\n  // –û—à–∏–±–∫–∞ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –º—ã —Ç–µ—Å—Ç–∏—Ä—É–µ–º –Ω–æ–¥—É –æ—Ç–¥–µ–ª—å–Ω–æ –∏ n8n –Ω–µ –≤–∏–¥–∏—Ç –ø—Ä–æ—à–ª—ã–µ —à–∞–≥–∏\n  console.log('–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º: –ù–æ–¥–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞');\n}\n\n// –ü–æ–ø—ã—Ç–∫–∞ 2: –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ (–∏–ª–∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º), –±–µ—Ä–µ–º ID –∏–∑ —Ä–µ—Ü–µ–ø—Ç–∞ (–µ—Å–ª–∏ –≤–¥—Ä—É–≥ –æ–Ω —Ç–∞–º –µ—Å—Ç—å) \n// –∏–ª–∏ —Å—Ç–∞–≤–∏–º –ó–ê–ì–õ–£–®–ö–£, —á—Ç–æ–±—ã —Ç—ã —É–≤–∏–¥–µ–ª, —á—Ç–æ –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç.\nif (!reviewId) {\n   reviewId = \"00000000-0000-0000-0000-000000000000\"; // –¢–µ—Å—Ç–æ–≤—ã–π ID (—á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ undefined)\n}\n\n// 3. –ü–û–õ–£–ß–ê–ï–ú –î–ê–¢–£\nlet baseDateStr;\ntry {\n   // –ü—ã—Ç–∞–µ–º—Å—è –≤–∑—è—Ç—å –¥–∞—Ç—É –æ—Ç AI (–≤–µ—Ç–∫–∞ –ü–ª–∞–Ω)\n   baseDateStr = $('AI: –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç—ã').first().json.output;\n} catch (e) {\n   // –ï—Å–ª–∏ –≤–µ—Ç–∫–∞ \"–°–µ–π—á–∞—Å\" –∏–ª–∏ –æ—à–∏–±–∫–∞ ‚Äî –±–µ—Ä–µ–º —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è\n   baseDateStr = new Date().toISOString();\n}\nconst baseDate = new Date(baseDateStr);\n\nconst results = [];\n\n// 4. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∑–∞–¥–∞—á–∏\nfor (const recipe of recipes) {\n  let publishAt = new Date(baseDate);\n  \n  // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–¥–µ—Ä–∂–∫—É (–µ—Å–ª–∏ —ç—Ç–æ –Ω–µ –≥–ª–∞–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞)\n  if (!recipe.is_main) {\n    publishAt.setHours(publishAt.getHours() + (recipe.delay_hours || 0));\n  }\n\n  results.push({\n    json: {\n      review_id: reviewId,\n      platform: recipe.platform,\n      status: 'queued',\n      publish_at: publishAt.toISOString(),\n      created_at: new Date().toISOString()\n    }\n  });\n}\n\nreturn results;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -3424,
        2976
      ],
      "id": "5d4ed5fc-4b9a-42e0-b4d7-4e3bae130e6a",
      "name": "–ö–æ–¥: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Jobs"
    },
    {
      "parameters": {
        "tableId": "publish_jobs",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "review_id",
              "fieldValue": "={{ $json.review_id }}"
            },
            {
              "fieldId": "platform",
              "fieldValue": "={{ $json.platform }}"
            },
            {
              "fieldId": "status",
              "fieldValue": "={{ $json.status }}"
            },
            {
              "fieldId": "created_at",
              "fieldValue": "={{ $json.created_at }}"
            },
            {
              "fieldId": "publish_at",
              "fieldValue": "={{ $json.publish_at }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -3200,
        2976
      ],
      "id": "c476827b-1f05-4a64-b83e-6ed6ba76c53b",
      "name": "Create a row",
      "executeOnce": false,
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "tableId": "publish_recipes",
        "filters": {
          "conditions": [
            {
              "keyName": "is_active",
              "condition": "eq",
              "keyValue": "true"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -2192,
        4560
      ],
      "id": "11a55a43-2835-4783-a0ab-2078063dbd6d",
      "name": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å –†–µ—Ü–µ–ø—Ç—ã1",
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// 1) Recipes\nconst recipes = $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å –†–µ—Ü–µ–ø—Ç—ã1').all().map(r => r.json);\n\n// 2) News id (take from \"–ß—Ç–æ –ø—Ä–∞–≤–∏–º?\")\nconst reviewId = $('–ß—Ç–æ –ø—Ä–∞–≤–∏–º?').first().json.id;\nif (!reviewId) throw new Error('review_id is missing in node \"–ß—Ç–æ –ø—Ä–∞–≤–∏–º?\" (field: id)');\n\n// 3) Base datetime: take from AI node if possible\nconst aiItem = $('AI: –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç—ã').first().json;\nconst aiStr = aiItem && aiItem.output ? String(aiItem.output) : '';\n\nlet baseMs = Date.parse(aiStr);\nif (Number.isNaN(baseMs)) {\n  baseMs = Date.now();\n}\n\n// 4) Build jobs\nconst nowIso = new Date().toISOString();\nconst results = [];\n\nfor (const recipe of recipes) {\n  const delayHours = Number(recipe.delay_hours || 0);\n  const isMain = recipe.is_main === true;\n\n  const publishMs = isMain ? baseMs : (baseMs + delayHours * 3600 * 1000);\n\n  results.push({\n    json: {\n      review_id: reviewId,\n      platform: recipe.platform,\n      status: 'queued',\n      publish_at: new Date(publishMs).toISOString(),\n      created_at: nowIso,\n    }\n  });\n}\n\nreturn results;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1984,
        4560
      ],
      "id": "d0778cab-a9e7-4e82-b134-000877ebcce7",
      "name": "–ö–æ–¥: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Jobs1"
    },
    {
      "parameters": {
        "operation": "update",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "condition": "eq",
              "keyValue": "={{ $json.review_id }}"
            }
          ]
        },
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "status",
              "fieldValue": "approved_for_publish"
            },
            {
              "fieldId": "rewrite2_state",
              "fieldValue": "={{ null }}"
            },
            {
              "fieldId": "approve2_decision",
              "fieldValue": "approved"
            },
            {
              "fieldId": "approve2_decided_at",
              "fieldValue": "={{ $now }}"
            },
            {
              "fieldId": "approve2_decided_by",
              "fieldValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.from_id }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -1568,
        4560
      ],
      "id": "0cb9b0dc-af86-41b0-98a9-54e8d0607194",
      "name": "–ë–î: –°—Ç–∞—Ç—É—Å Approved1",
      "executeOnce": true,
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Article context (short):\n{{ ($json.draft_announce || '').slice(0, 900) }}\n\nAdmin visual notes (optional, short):\n{{ (($('–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç').item.json.text || '') + '').slice(0, 600) }}\n\n",
        "options": {
          "systemMessage": "–°–æ—Å—Ç–∞–≤—å –∫–æ—Ä–æ—Ç–∫–∏–π –ø—Ä–æ–º—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, —É—á–∏—Ç—ã–≤–∞—è –∫–æ–Ω—Ç–µ–∫—Å—Ç –∞–Ω–æ–Ω—Å–∞ –∏ –∑–∞–º–µ—Ç–∫–∏ –∞–¥–º–∏–Ω–∞. "
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        -2480,
        4112
      ],
      "id": "f75689a1-c33c-44b8-8f5d-8e8e4b82844b",
      "name": "AI: –ü—Ä–æ–º—Ç –¥–ª—è DALL-E",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=–¢—ã ‚Äî —Ä–µ–¥–∞–∫—Ç–æ—Ä Telegram-–∫–∞–Ω–∞–ª–∞ –ø—Ä–æ –æ—Ö–æ—Ç—É.\n\n–¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∞–Ω–æ–Ω—Å, —É–ª—É—á—à–∏–≤ —Å—Ç–∏–ª—å –∏ –∏–Ω—Ç—Ä–∏–≥—É, \n–ù–û –°–¢–†–û–ì–û –°–û–ë–õ–Æ–î–ê–Ø –°–¢–†–£–ö–¢–£–†–£ –ò –§–û–†–ú–ê–¢ –í–´–•–û–î–ê.\n\n–°–¢–†–£–ö–¢–£–†–ê –í–´–•–û–î–ù–û–ì–û –¢–ï–ö–°–¢–ê (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û):\n1) –ò–Ω—Ç—Ä–∏–≥–∞ ‚Äî 2‚Äì3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è.\n2) –•—ç—à—Ç–µ–≥–∏ ‚Äî —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏, 2‚Äì3 —Ç–µ–≥–∞, –±–µ–∑ #–û—Ö–æ—Ç–∞.\n3) –ü—Ä–∏–∑—ã–≤ ‚Äî –°–¢–†–û–ì–û –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–æ–π.\n\n–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–ê–í–ò–õ–ê (–ù–ê–†–£–®–ê–¢–¨ –ó–ê–ü–†–ï–©–ï–ù–û):\n- –ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä–∏–∑—ã–≤–æ–º.\n- –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–∏–º–≤–æ–ª –≤—Å–µ–≥–æ —Ç–µ–∫—Å—Ç–∞ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–≤–æ–µ—Ç–æ—á–∏–µ–º (:).\n- –ü–æ—Å–ª–µ –¥–≤–æ–µ—Ç–æ—á–∏—è –ù–ò–ß–ï–ì–û –Ω–µ –ø–∏—Å–∞—Ç—å: –Ω–∏ –ø—Ä–æ–±–µ–ª–æ–≤, –Ω–∏ —Å—Å—ã–ª–æ–∫, –Ω–∏ —Å–∏–º–≤–æ–ª–æ–≤.\n- –ó–∞–ø—Ä–µ—â–µ–Ω–æ —É–¥–∞–ª—è—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω—è—Ç—å —Ñ–æ—Ä–º–∞—Ç –ø—Ä–∏–∑—ã–≤–∞.\n- –ï—Å–ª–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–∑—ã–≤ –±—ã–ª —É—Ç–µ—Ä—è–Ω ‚Äî –í–û–°–°–¢–ê–ù–û–í–ò –µ–≥–æ.\n\n–î–û–ü–£–°–¢–ò–ú–´–ï –í–ê–†–ò–ê–ù–¢–´ –ü–†–ò–ó–´–í–ê (–≤—ã–±–µ—Ä–∏ –æ–¥–∏–Ω):\n- –ß–∏—Ç–∞—Ç—å –¥–∞–ª–µ–µ:\n- –ü–æ–¥—Ä–æ–±–Ω–µ–µ –ø–æ —Å—Å—ã–ª–∫–µ:\n- –ü–æ–ª–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Å–∏—Ç—É–∞—Ü–∏–∏:\n- –ß–∏—Ç–∞–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –Ω–∞ —Å–∞–π—Ç–µ:\n\n–û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø:\n- –û–±—â–∞—è –¥–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞ ‚Äî –Ω–µ –±–æ–ª–µ–µ 900 —Å–∏–º–≤–æ–ª–æ–≤.\n- –¢–æ–Ω: –∂–∏–≤–æ–π, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π, –±–µ–∑ –≤–æ–¥—ã.\n\n–ò–°–•–û–î–ù–´–ï –î–ê–ù–ù–´–ï:\n–ò—Å—Ö–æ–¥–Ω—ã–π –∞–Ω–æ–Ω—Å:\n{{ $json.draft_announce }}\n\n–ü–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:\n{{ $('–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç').item.json.text }}\n\n–ü–ï–†–ï–î –í–´–í–û–î–û–ú:\n–ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –ø—Ä–∏–∑—ã–≤ –∏ —Ç–µ–∫—Å—Ç –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –¥–≤–æ–µ—Ç–æ—á–∏–µ–º.\n\n–í–µ—Ä–Ω–∏ –¢–û–õ–¨–ö–û —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –∞–Ω–æ–Ω—Å–∞. –ë–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.\n",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        -2560,
        3248
      ],
      "id": "3fa88573-e7e7-4181-9227-4e4f9a374187",
      "name": "AI: –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∞–Ω–æ–Ω—Å",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=–°–µ–π—á–∞—Å: {{ $now }}. –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å +3 (–ú–æ—Å–∫–≤–∞).\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–ø–∏—Å–∞–ª: \n{{ $('–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç').item.json.text }}\n\n–ó–ê–î–ê–ß–ê:\n–ü–µ—Ä–µ–≤–µ–¥–∏ —ç—Ç–æ—Ç —Ç–µ–∫—Å—Ç –≤ –¥–∞—Ç—É —Ñ–æ—Ä–º–∞—Ç–∞ ISO 8601 (YYYY-MM-DDTHH:mm:ssZ).\n–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–ø–∏—Å–∞–ª \"–∑–∞–≤—Ç—Ä–∞ –≤ 10\", —Å—á–∏—Ç–∞–π –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.\n–í–µ—Ä–Ω–∏ –¢–û–õ–¨–ö–û —Å—Ç—Ä–æ–∫—É –¥–∞—Ç—ã.",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        -2512,
        4560
      ],
      "id": "09cea80f-3593-4d86-a489-5c537d47bd70",
      "name": "AI: –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç—ã",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=–ò—Å—Ö–æ–¥–Ω—ã–π –ª–æ–Ω–≥—Ä–∏–¥:\n{{ $json.draft_longread }}\n\n–ó–ê–î–ê–ß–ê:\n–ü–µ—Ä–µ–ø–∏—à–∏ –ª–æ–Ω–≥—Ä–∏–¥, —É—á–∏—Ç—ã–≤–∞—è –ø–æ–∂–µ–ª–∞–Ω–∏—è:\n{{ $('–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç').item.json.text }}\n\n–í–µ—Ä–Ω–∏ –¢–û–õ–¨–ö–û markdown —Ç–µ–∫—Å—Ç.",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        -2544,
        3648
      ],
      "id": "0a867773-6b38-4a3c-b029-7ca1d8133f9f",
      "name": "AI: –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ª–æ–Ω–≥—Ä–∏–¥",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.can_edit }}",
              "value2": true
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        -480,
        3648
      ],
      "id": "e62db0ab-fb2d-4ab1-9c3a-31560de259f2",
      "name": "IF: –ú–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–∏—Ç—å?"
    },
    {
      "parameters": {
        "operation": "editMessageText",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1').item.json.approve2_longread_msg_ids[0] }}",
        "text": "=‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: \n\n{{ $json.chunks[0] }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -304,
        3008
      ],
      "id": "07729942-2027-4201-890f-f09a26e28ff0",
      "name": "TG: –ü—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–∏—Ç—å (Edit)",
      "webhookId": "141c058f-8709-4061-913f-7474dc4629ab",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –£–î–ê–õ–ï–ù–ò–Æ –°–¢–ê–†–´–• –°–û–û–ë–©–ï–ù–ò–ô\nreturn $json.old_ids.map(id => ({ json: { msg_id: id } }));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        16,
        3808
      ],
      "id": "08d2674f-d33b-4de2-9164-0ed913c016bb",
      "name": "–ö–æ–¥: ID –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        224,
        3808
      ],
      "id": "253c5804-bc88-4967-853f-78ffc4cae474",
      "name": "–¶–∏–∫–ª: –£–¥–∞–ª–µ–Ω–∏–µ"
    },
    {
      "parameters": {
        "operation": "deleteMessage",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $json.msg_id }}"
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        448,
        3952
      ],
      "id": "887f0ceb-dba0-4e52-896a-44365aaf190c",
      "name": "TG: –£–¥–∞–ª–∏—Ç—å (Loop)",
      "webhookId": "1a976dce-b778-42a1-ab53-c8e3273e2c5c",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// 1. –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ (–º–∞—Å—Å–∏–≤ —á–∞–Ω–∫–æ–≤ –∏–ª–∏ —Å—ã—Ä–æ–π —Ç–µ–∫—Å—Ç) –∏–∑ –Ω–æ–¥—ã –∞–Ω–∞–ª–∏–∑–∞\n// –í–∞–∂–Ω–æ: –≤ —Ç–≤–æ–µ–º —Å–ª—É—á–∞–µ –¥–∞–Ω–Ω—ã–µ –ª–µ–∂–∞—Ç –≤ –Ω–æ–¥–µ \"–ö–æ–¥: –ê–Ω–∞–ª–∏–∑ (Edit –∏–ª–∏ Rebuild?)\"\nconst analysisNode = $('–ö–æ–¥: –ê–Ω–∞–ª–∏–∑ (Edit –∏–ª–∏ Rebuild?)').first();\nlet chunks = analysisNode ? analysisNode.json.chunks : [];\n\n// –ó–ê–©–ò–¢–ê: –ï—Å–ª–∏ —á–∞–Ω–∫–æ–≤ –Ω–µ—Ç –∏–ª–∏ –æ–Ω–∏ –ø—É—Å—Ç—ã–µ\nif (!chunks || chunks.length === 0) {\n  return []; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç–æ—Ç—É, —á—Ç–æ–±—ã —Ü–∏–∫–ª –Ω–µ —Å–ª–æ–º–∞–ª—Å—è\n}\n\n// 2. –§–£–ù–ö–¶–ò–Ø –û–ß–ò–°–¢–ö–ò (–°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ)\n// –£–±–∏—Ä–∞–µ—Ç ```markdown –≤ –Ω–∞—á–∞–ª–µ –∏ ``` –≤ –∫–æ–Ω—Ü–µ, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å\nfunction cleanText(text) {\n  if (!text) return \"\";\n  return String(text)\n    .replace(/^```[a-z]*\\s*/i, \"\") // –£–±–∏—Ä–∞–µ—Ç ```markdown\n    .replace(/```\\s*$/, \"\")         // –£–±–∏—Ä–∞–µ—Ç ``` –≤ –∫–æ–Ω—Ü–µ\n    .trim();\n}\n\n// 3. –§–æ—Ä–º–∏—Ä—É–µ–º –º–∞—Å—Å–∏–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏\n// –ü—Ä–æ—Ö–æ–¥–∏–º—Å—è –ø–æ –≤—Å–µ–º —á–∞–Ω–∫–∞–º –∏ —á–∏—Å—Ç–∏–º –∫–∞–∂–¥—ã–π (–Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π)\nreturn chunks.map((chunk, i) => {\n  const cleanChunk = cleanText(chunk);\n  \n  // –î–æ–±–∞–≤–ª—è–µ–º –Ω—É–º–µ—Ä–∞—Ü–∏—é [1/3], –µ—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –±–æ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ\n  const prefix = chunks.length > 1 ? `[${i + 1}/${chunks.length}]\\n\\n` : \"\";\n  \n  return {\n    json: {\n      text: prefix + cleanChunk\n    }\n  };\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        480,
        3712
      ],
      "id": "ed90ae6f-520b-4046-9012-cec390d13606",
      "name": "–ö–æ–¥: –ß–∞–Ω–∫–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        688,
        3712
      ],
      "id": "f7842b6c-6c53-42f5-bc2f-c65ee18b9b26",
      "name": "–¶–∏–∫–ª: –û—Ç–ø—Ä–∞–≤–∫–∞"
    },
    {
      "parameters": {
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "text": "=‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: \n\n{{ $json.text }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        960,
        3872
      ],
      "id": "1507ce40-62b0-4c83-a2b6-5d0932e4228f",
      "name": "TG: –û—Ç–ø—Ä–∞–≤–∏—Ç—å (Loop)",
      "webhookId": "4be7477a-5f4e-41ec-8d2f-7d83889ccbc8",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "operation": "editMessageText",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1').item.json.approve2_message_id }}",
        "replyMarkup": "inlineKeyboard",
        "text": "=‚úÖ –õ–æ–Ω–≥—Ä–∏–¥ –æ–±–Ω–æ–≤–ª–µ–Ω. –ü—É–±–ª–∏–∫—É–µ–º –æ–±–∑–æ—Ä?",
        "inlineKeyboard": {
          "rows": [
            {
              "row": {
                "buttons": [
                  {
                    "text": "‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è",
                    "additionalFields": {
                      "callback_data": "={{ 'A2|' + $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1').item.json.id }}"
                    }
                  },
                  {
                    "text": "‚úçÔ∏è –ü—Ä–∞–≤–∫–∏",
                    "additionalFields": {
                      "callback_data": "={{ 'R2|' + $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1').item.json.id }}"
                    }
                  },
                  {
                    "text": "üóëÔ∏è –°–∫–∏–ø",
                    "additionalFields": {
                      "callback_data": "={{ 'X2|' + $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1').item.json.id }}"
                    }
                  }
                ]
              }
            }
          ]
        },
        "additionalFields": {
          "parse_mode": "Markdown"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -96,
        3008
      ],
      "id": "3bc69760-ae48-424e-a628-198dc7650945",
      "name": "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ + –∫–Ω–æ–ø–∫–∏2",
      "webhookId": "455f169c-1494-4300-baa5-67d13265f56f",
      "executeOnce": true,
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "operation": "deleteMessage",
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "messageId": "={{ $('–ö–æ–¥: –ê–Ω–∞–ª–∏–∑ (Edit –∏–ª–∏ Rebuild?)').first().json.old_btn_id }}"
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        1888,
        3664
      ],
      "id": "4950a24a-4167-4c16-8489-e1e52be5f597",
      "name": "TG: –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–Ω–æ–ø–∫–∏",
      "webhookId": "455f169c-1494-4300-baa5-67d13265f56f",
      "executeOnce": true,
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "const nodeName = \"TG: –û—Ç–ø—Ä–∞–≤–∏—Ç—å (Loop)\";\nconst allIds = [];\nlet runIndex = 0;\nlet safetyBreak = 0;\n\n// 1. –ë–ï–°–ö–û–ù–ï–ß–ù–´–ô –¶–ò–ö–õ –ü–û –ò–°–¢–û–†–ò–ò –ó–ê–ü–£–°–ö–û–í\nwhile(safetyBreak < 100) {\n    try {\n        // $items(–ò–º—è–ù–æ–¥—ã, –ò–Ω–¥–µ–∫—Å–í—ã—Ö–æ–¥–∞, –ò–Ω–¥–µ–∫—Å–ó–∞–ø—É—Å–∫–∞)\n        const executionItems = $items(nodeName, 0, runIndex);\n        \n        if (!executionItems || executionItems.length === 0) {\n            break;\n        }\n\n        // –ó–∞–±–∏—Ä–∞–µ–º ID\n        executionItems.forEach(item => {\n            if (item.json.result && item.json.result.message_id) {\n                allIds.push(item.json.result.message_id);\n            }\n        });\n\n        runIndex++;\n        safetyBreak++;\n    } catch (error) {\n        break;\n    }\n}\n\n// 2. –ü–æ–ª—É—á–∞–µ–º ID –æ–±–∑–æ—Ä–∞ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–≤—ã—à–µ –ø–æ –ø–æ—Ç–æ–∫—É)\nlet reviewId = null;\ntry {\n  // –í —ç—Ç–æ–º —É—á–∞—Å—Ç–∫–µ —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã–µ –ª–µ–∂–∞—Ç –≤ –Ω–æ–¥–µ \"–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1\"\n  reviewId = $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1').first().json.id;\n} catch(e) {\n  reviewId = null;\n}\n\nreturn {\n    json: {\n        review_id: reviewId,\n        final_review_id: reviewId,\n        final_msg_ids: JSON.stringify(allIds), \n        count: allIds.length\n    }\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        960,
        3664
      ],
      "id": "518a3d74-b0e6-415d-b32a-da2469f676c1",
      "name": "–ö–æ–¥: –°–æ–±—Ä–∞—Ç—å ID (Rebuild)"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE public.review_items\nSET\n  approve2_longread_msg_ids = $2\nWHERE id = $1;",
        "options": {
          "queryReplacement": "={{ [ $json.final_review_id, $json.final_msg_ids ] }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2,
      "position": [
        1184,
        3664
      ],
      "id": "f21f5258-d955-407c-bbc9-286d113785e1",
      "name": "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–Ω–≥—Ä–∏–¥ (Rebuild)",
      "credentials": {
        "postgres": {
          "id": "Apw2GZOwP2Hlrwwo",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE public.review_items\nSET\n  approve2_message_id = $2,\n  approve2_chat_id = $3\nWHERE id = $1;",
        "options": {
          "queryReplacement": "={{ [\n  $('–ö–æ–¥: –°–æ–±—Ä–∞—Ç—å ID (Rebuild)').first().json.final_review_id,\n  $json.result.message_id,\n  $json.result.chat.id\n] }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2,
      "position": [
        1632,
        3664
      ],
      "id": "55805d0c-9cd5-408e-80f5-df92a25fa3ee",
      "name": "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–Ω–æ–ø–∫—É (Rebuild)",
      "credentials": {
        "postgres": {
          "id": "Apw2GZOwP2Hlrwwo",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤').first().json.approve_chat_id }}",
        "text": "‚úÖ –õ–æ–Ω–≥—Ä–∏–¥ –æ–±–Ω–æ–≤–ª–µ–Ω. –ü—É–±–ª–∏–∫—É–µ–º?",
        "replyMarkup": "inlineKeyboard",
        "inlineKeyboard": {
          "rows": [
            {
              "row": {
                "buttons": [
                  {
                    "text": "‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è",
                    "additionalFields": {
                      "callback_data": "={{ 'A2|' + $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1').first().json.id }}"
                    }
                  },
                  {
                    "text": "‚úçÔ∏è –ü—Ä–∞–≤–∫–∏",
                    "additionalFields": {
                      "callback_data": "={{ 'R2|' + $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1').first().json.id }}"
                    }
                  },
                  {
                    "text": "üóëÔ∏è –í –∫–æ—Ä–∑–∏–Ω—É",
                    "additionalFields": {
                      "callback_data": "={{ 'X2|' + $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1').first().json.id }}"
                    }
                  }
                ]
              }
            }
          ]
        },
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        1408,
        3664
      ],
      "id": "41cb955d-73c3-4116-ab15-97faaa2d7b72",
      "name": "TG: –ê–ø—Ä—É–≤-2 (–ù–û–í–´–ï –∫–Ω–æ–ø–∫–∏)1",
      "webhookId": "d8c99276-b352-4077-831b-02939ef152e6",
      "executeOnce": true,
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "efd22d68-eb0e-41f4-b904-ed8f72126447",
              "leftValue": "={{ $json.title }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notEmpty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        -2960,
        1920
      ],
      "id": "c44037b1-2ae5-4fbc-958f-6003325f4710",
      "name": "–ï—Å–ª–∏: –£–∂–µ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –ø—Ä–∞–≤–∫–∞?"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT title FROM public.review_items\nWHERE rewrite2_state IS NOT NULL\nAND id != $1\nLIMIT 1;",
        "options": {
          "queryReplacement": "={{ [ $json.callback_query.data.split('|')[1] ] }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -3264,
        1920
      ],
      "id": "045fb3f5-e425-458f-9a0d-7db316e68314",
      "name": "–ë–î: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏",
      "alwaysOutputData": true,
      "credentials": {
        "postgres": {
          "id": "Apw2GZOwP2Hlrwwo",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "operation": "editMessageText",
        "chatId": "={{ $('Telegram Trigger').first().json.callback_query.message.chat.id }}",
        "messageId": "={{ $('Telegram Trigger').first().json.callback_query.message.message_id }}",
        "replyMarkup": "inlineKeyboard",
        "text": "=–ù–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–≤–µ –æ–±–∑–æ—Ä–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ!\n–°–µ–π—á–∞—Å –≤ —Ä–∞–±–æ—Ç–µ:\n{{ $json.title }}.  \n–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≤–µ—Ä—à–∏—Ç–µ –µ—ë, –∞ –ø–æ—Ç–æ–º –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ —ç—Ç–æ–π.",
        "inlineKeyboard": {
          "rows": [
            {
              "row": {
                "buttons": [
                  {
                    "text": "üîô –ü–æ–Ω—è–ª",
                    "additionalFields": {
                      "callback_data": "={{ 'CancelEdit|' + $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.review_id }}"
                    }
                  }
                ]
              }
            }
          ]
        },
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -2672,
        1904
      ],
      "id": "d50cca38-9fb4-4ae9-89bb-708163cf9e9e",
      "name": "TG: –û—à–∏–±–∫–∞ (–ó–∞–Ω—è—Ç–æ)",
      "webhookId": "3413bd5b-5e01-41c8-b319-7c58070d1657",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.telegram.org/bot8509009391:AAGBWp-mq4OGs7WZJH0umlu8-0JORZc_H7A/editMessageMedia",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "chat_id",
              "value": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ2').item.json.approve2_chat_id }}"
            },
            {
              "name": "message_id",
              "value": "={{ $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ2').item.json.approve2_photo_message_id }}"
            },
            {
              "name": "media",
              "value": "={{ JSON.stringify({ type: 'photo', media: 'attach://photo', caption: $('–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ2').item.json.title || '', parse_mode: 'HTML' }) }}"
            },
            {
              "parameterType": "formBinaryData",
              "name": "photo",
              "inputDataFieldName": "photo"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -1248,
        4112
      ],
      "id": "8c6ea527-5ee5-41ba-a5e0-996818dfeeb3",
      "name": "HTTP Request1",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "condition": "eq",
              "keyValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.review_id }}"
            }
          ]
        },
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "approve2_decision",
              "fieldValue": "skip"
            },
            {
              "fieldId": "approve2_decided_at",
              "fieldValue": "={{ $now }}"
            },
            {
              "fieldId": "approve2_decided_by",
              "fieldValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.from_id }}"
            },
            {
              "fieldId": "rewrite2_state",
              "fieldValue": "={{ null }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -3392,
        2368
      ],
      "id": "a22c17b8-d6cc-4f90-b81d-b6ec32d774d3",
      "name": "–ë–î: –°–∫–∏–ø (X2)",
      "executeOnce": true,
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "tableId": "review_items",
        "filters": {
          "conditions": [
            {
              "keyName": "id",
              "condition": "eq",
              "keyValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.review_id }}"
            }
          ]
        },
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "approve2_decision",
              "fieldValue": "approved"
            },
            {
              "fieldId": "approve2_decided_at",
              "fieldValue": "={{ $now }}"
            },
            {
              "fieldId": "approve2_decided_by",
              "fieldValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.from_id }}"
            },
            {
              "fieldId": "status",
              "fieldValue": "approved_for_publish"
            },
            {
              "fieldId": "rewrite2_state",
              "fieldValue": "={{ null }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -3008,
        2976
      ],
      "id": "b90ecb92-7836-4637-86f8-f90462941fbd",
      "name": "–ë–î: –°—Ç–∞—Ç—É—Å Approved",
      "executeOnce": true,
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "tableId": "publish_jobs",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "review_id",
              "fieldValue": "={{ $('–ë–î: –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É—é –ø—Ä–∞–≤–∫—É').first().json.id }}"
            },
            {
              "fieldId": "platform",
              "fieldValue": "={{ $json.platform }}"
            },
            {
              "fieldId": "status",
              "fieldValue": "={{ $json.status }}"
            },
            {
              "fieldId": "created_at",
              "fieldValue": "={{ $json.created_at }}"
            },
            {
              "fieldId": "publish_at",
              "fieldValue": "={{ $json.publish_at }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        -1792,
        4560
      ],
      "id": "85d75a1a-90b8-4002-bd1a-c5dce0c0e289",
      "name": "–°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏",
      "executeOnce": false,
      "credentials": {
        "supabaseApi": {
          "id": "0jybqWrEmbw0Wb5i",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "model": "openai/gpt-5.2",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        -2544,
        3872
      ],
      "id": "e1655fa2-6f31-4993-8a95-a6bd726d157b",
      "name": "r. gpt 5.2",
      "credentials": {
        "openRouterApi": {
          "id": "OPxPNafAYGtjuKlH",
          "name": "AI News"
        }
      }
    },
    {
      "parameters": {
        "model": "openai/gpt-5.2",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        -2480,
        4304
      ],
      "id": "547585d3-ee04-4c5a-953c-386cc7627515",
      "name": "r. gpt 5.2 (1)",
      "credentials": {
        "openRouterApi": {
          "id": "OPxPNafAYGtjuKlH",
          "name": "AI News"
        }
      }
    },
    {
      "parameters": {
        "model": "openai/gpt-5.2",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        -2560,
        3456
      ],
      "id": "f451a120-8947-4467-bdfd-e233521c28df",
      "name": "r. gpt 5.2 (2)",
      "credentials": {
        "openRouterApi": {
          "id": "OPxPNafAYGtjuKlH",
          "name": "AI News"
        }
      }
    },
    {
      "parameters": {
        "model": "openai/gpt-5-nano",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        -2512,
        4784
      ],
      "id": "1bc4325a-f66c-4c26-ae92-5d9c25bf5fea",
      "name": "r. gpt 5  nano",
      "credentials": {
        "openRouterApi": {
          "id": "OPxPNafAYGtjuKlH",
          "name": "AI News"
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "const msg = $json.choices?.[0]?.message || {};\nconst dataUrl =\n  msg.images?.[0]?.image_url?.url ||\n  msg.images?.[0]?.imageUrl?.url;\n\nif (!dataUrl || !dataUrl.startsWith(\"data:\")) {\n  throw new Error(\"No image data URL\");\n}\n\nconst comma = dataUrl.indexOf(\",\");\nconst meta = dataUrl.slice(5, comma); // \"image/png;base64\"\nconst mimeType = meta.split(\";\")[0];\nconst base64 = dataUrl.slice(comma + 1);\n\nconst bytes = Math.floor(base64.length * 3 / 4);\nconst mb = +(bytes / 1024 / 1024).toFixed(2);\n\nreturn {\n  json: {\n    size_mb: mb,\n    caption: msg.content || \"\"\n  },\n  binary: {\n    photo: {\n      data: base64,\n      mimeType: mimeType,\n      fileName: \"img.png\"\n    }\n  }\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1904,
        4112
      ],
      "id": "7ff3758b-de70-43ed-9a92-ba2d2ae190dc",
      "name": "DataURL -> Binary"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://openrouter.ai/api/v1/chat/completions",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "HTTP-Referer",
              "value": "https://n8n.io"
            },
            {
              "name": "X-Title",
              "value": "n8n-dev"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={ \"model\": \"google/gemini-2.5-flash-image\",\n  \"messages\": [{ \"role\": \"user\", \"content\": \"{{ $json.output }}\" }],\n  \"modalities\": [\"image\", \"text\"],\n  \"image_config\": {\n    \"aspect_ratio\": \"16:9\",\n    \"image_size\": \"1K\"\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -2144,
        4112
      ],
      "id": "f4d4e026-e847-4723-bc37-13864d8f10ec",
      "name": "OpenRouter: Image1",
      "credentials": {
        "httpHeaderAuth": {
          "id": "Ujxf37NtSZLQ3mZC",
          "name": "Openrouter API"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -1440,
        4112
      ],
      "id": "e9ff3215-5729-4b91-a43e-ba7cc0ffd6b6",
      "name": "Merge3"
    },
    {
      "parameters": {
        "operation": "sendDocument",
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "file": "={{ $json.draft_image_file_id }}",
        "additionalFields": {
          "caption": "={{ $json.draft_title }}"
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -784,
        144
      ],
      "id": "2fa8e2f9-0dd2-4323-a3f8-29b8fb5a8821",
      "name": "TG: –ê–ø—Ä—É–≤-2 (—Ñ–∞–π–ª)",
      "webhookId": "c1c059d9-ef0b-4802-a0a2-ab0831089ec4",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "854cbf3c-d37b-44d0-a022-ec4696c5ae4d",
              "leftValue": "={{ $json.draft_image_file_id }}",
              "rightValue": "BQ",
              "operator": {
                "type": "string",
                "operation": "startsWith"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        -1088,
        368
      ],
      "id": "0488bb59-3e69-43e5-86ea-cc786acb28ca",
      "name": "–≠—Ç–æ —Ñ–∞–π–ª –∏–ª–∏ —Ñ–æ—Ç–æ?"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE public.review_items\nSET\n  approve2_photo_message_id = $2,\n  draft_image_file_id = $3\nWHERE id = $1;",
        "options": {
          "queryReplacement": "={{ [\n  $('DB: Save Drafts').first().json.review_id,\n  $json.result.message_id,\n  ($json.result.photo ? $json.result.photo.slice(-1)[0].file_id : $json.result.document.file_id)\n] }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -336,
        368
      ],
      "id": "84b59b0e-fec9-471c-8021-4ebc91dcac71",
      "name": "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ID —Ñ–æ—Ç–æ",
      "credentials": {
        "postgres": {
          "id": "Apw2GZOwP2Hlrwwo",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "98877d50-9e2c-4776-89d7-d7a6a8ae1d46",
              "leftValue": "={{ $('Execute a SQL query').item.json.status }}",
              "rightValue": "drafts_ready",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        -4304,
        688
      ],
      "id": "8014a247-4082-4e2d-9c95-dd1b3798f276",
      "name": "If1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "65b674ca-5fe6-4d75-b5c9-d2c7a9523686",
              "name": "result.text",
              "value": "READY",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3888,
        848
      ],
      "id": "ceb51e24-abad-4a88-b2ed-661291639928",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "UPDATE public.review_items\nSET\n  -- –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π ID –≤ –∫–æ–Ω–µ—Ü —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –º–∞—Å—Å–∏–≤–∞ (–∏–ª–∏ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π)\n  approve2_longread_msg_ids = COALESCE(approve2_longread_msg_ids, '[]'::jsonb) || jsonb_build_array($2::bigint)\nWHERE id = $1;",
        "options": {
          "queryReplacement": "={{ [\n  $('DB: Save Drafts').first().json.review_id,\n  $json.result.message_id\n] }}"
        }
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        1168,
        864
      ],
      "id": "e5a03f8f-82ab-448d-96ba-8010a90bd253",
      "name": "–ë–î: –î–æ–±–∞–≤–∏—Ç—å ID –≤ –º–∞—Å—Å–∏–≤",
      "credentials": {
        "postgres": {
          "id": "Apw2GZOwP2Hlrwwo",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "–°–Ω–∞—á–∞–ª–∞ –æ–ø—É–±–ª–∏–∫—É–π –∏–ª–∏ —Å–∫–∏–ø–Ω–∏ –Ω–æ–≤–æ—Å—Ç—å!",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        -4976,
        512
      ],
      "id": "060dc20e-1a64-4214-b5ca-5aef019fa3e4",
      "name": "Send a text message1",
      "webhookId": "9089adcc-1b65-46d0-91a3-039315b19ec7",
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 3
          },
          "conditions": [
            {
              "id": "8eb749e9-80ff-4f2c-9fd1-8bd28b3a2ad6",
              "leftValue": "={{ $json.status }}",
              "rightValue": "needs_review",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.3,
      "position": [
        -5200,
        528
      ],
      "id": "52442f49-ff74-49c9-bce9-fe75cae3b5df",
      "name": "–ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å?"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "6861ac48-1d95-42ab-8187-5c97cfd2223a",
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "A2",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  },
                  {
                    "id": "new-condition-a1",
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "A1",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "or"
              },
              "renameOutput": true,
              "outputKey": "A2 (–û–¥–æ–±—Ä–∏—Ç—å)"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "R2",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "R2 (–ü—Ä–∞–≤–∫–∏)"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "X2",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "X2 (–°–∫–∏–ø)"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "Edit",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–í—ã–±–æ—Ä —Ç–∏–ø–∞ –ø—Ä–∞–≤–∫–∏"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "CancelEdit",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–û—Ç–º–µ–Ω–∞"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "PubNow",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–ü—É–±–ª–∏–∫–∞—Ü–∏—è: –°–µ–π—á–∞—Å"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞').item.json.action }}",
                    "rightValue": "PubLater",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "–ü—É–±–ª–∏–∫–∞—Ü–∏—è: –ü–æ—Ç–æ–º"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        -4400,
        1888
      ],
      "id": "3f1428c6-174a-43af-9680-fa200ad59633",
      "name": "Switch: –î–µ–π—Å—Ç–≤–∏–µ1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "text": "–ü—É–±–ª–∏–∫—É–µ–º?",
        "replyMarkup": "inlineKeyboard",
        "inlineKeyboard": {
          "rows": [
            {
              "row": {
                "buttons": [
                  {
                    "text": "‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è",
                    "additionalFields": {
                      "callback_data": "={{ 'REVIEW_A1|' + $('DB: Save Drafts').first().json.review_id }}"
                    }
                  },
                  {
                    "text": "‚úçÔ∏è –ü—Ä–∞–≤–∫–∏",
                    "additionalFields": {
                      "callback_data": "={{ 'REVIEW_EDIT|' + $('DB: Save Drafts').first().json.review_id }}"
                    }
                  },
                  {
                    "text": "üóëÔ∏è –í –∫–æ—Ä–∑–∏–Ω—É",
                    "additionalFields": {
                      "callback_data": "={{ 'REVIEW_X1|' + $('DB: Save Drafts').first().json.review_id }}"
                    }
                  }
                ]
              }
            }
          ]
        },
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        768,
        592
      ],
      "id": "60f71a05-7afa-4ebb-959e-38ce13aaaef8",
      "name": "TG: –ê–ø—Ä—É–≤-2 (–∫–Ω–æ–ø–∫–∏)1",
      "webhookId": "8fcc92df-de95-45aa-8ccf-883a554fdbe2",
      "executeOnce": true,
      "credentials": {
        "telegramApi": {
          "id": "XWRfnd8MJgwnkvmg",
          "name": "KHC"
        }
      }
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "5C3i8zaCZxtLswTD",
          "mode": "list",
          "cachedResultUrl": "/workflow/5C3i8zaCZxtLswTD",
          "cachedResultName": "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–æ—Ü. —Å–µ—Ç–µ–π"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        -2864,
        2768
      ],
      "id": "2acaefa4-3264-498d-b7da-9ccab7921ab2",
      "name": "Call '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–æ—Ü. —Å–µ—Ç–µ–π'"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "5C3i8zaCZxtLswTD",
          "mode": "list",
          "cachedResultUrl": "/workflow/5C3i8zaCZxtLswTD",
          "cachedResultName": "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–æ—Ü. —Å–µ—Ç–µ–π"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {},
          "matchingColumns": [],
          "schema": [],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        -1648,
        4368
      ],
      "id": "45240051-0787-4d6e-a901-7fd1a79f6954",
      "name": "Call '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–æ—Ü. —Å–µ—Ç–µ–π'1"
    }
  ],
  "pinData": {
    "–ó–∞–≥–æ–ª–æ–≤–æ–∫": [
      {
        "json": {
          "output": "**Atlas BT65-LW17 Gen 2: —Å–æ—à–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –≤–∏–Ω—Ç–æ–≤–∫—É –≤ ¬´—Å—Ç–∞–Ω–æ–∫¬ª ‚Äî –∫–æ–º—É —Ä–µ–∞–ª—å–Ω–æ –Ω—É–∂–Ω–∞ –∏ –∫–∞–∫ –Ω–µ –ø—Ä–æ–º–∞—Ö–Ω—É—Ç—å—Å—è —Å –≤–µ—Ä—Å–∏–µ–π**"
        }
      }
    ],
    "LLM: –ê–Ω–æ–Ω—Å": [
      {
        "json": {
          "output": "<b>Atlas BT65-LW17 Gen. 2 CAL</b> ‚Äî –ø—Ä–µ–º–∏–∞–ª—å–Ω–∞—è —Ç–µ–ª–µ—Å–∫–æ–ø–∏—á–µ—Å–∫–∞—è —Å–æ—à–∫–∞ –¥–ª—è –æ—Ö–æ—Ç—ã –∏ —Ç–∞–∫—Ç–∏–∫–∏: –∂—ë—Å—Ç–∫–∞—è, —Å—Ç–∞–±–∏–ª—å–Ω–∞—è, —Å —Ç–æ—á–Ω–æ–π —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–æ–π –Ω–æ–≥ –∏ —É–¥–æ–±–Ω–æ–π —Ä–∞–±–æ—Ç–æ–π —Å —É–ø–æ—Ä–∞ (–∑–µ–º–ª—è, –∫–∞–ø–æ—Ç, –±—Ä–µ–≤–Ω–æ, —Ä—é–∫–∑–∞–∫).\n\n–í –ª–æ–Ω–≥—Ä–∏–¥—É ‚Äî –∫–æ–º—É –æ–Ω–∞ —Ä–µ–∞–ª—å–Ω–æ –Ω—É–∂–Ω–∞ (–æ—Ç –∑–∞—Å–∏–¥–∫–∏ –∏ –≥–æ—Ä –¥–æ —Ç—è–∂—ë–ª—ã—Ö –∫–∞–ª–∏–±—Ä–æ–≤), –≥–ª–∞–≤–Ω—ã–µ –ø–ª—é—Å—ã/–º–∏–Ω—É—Å—ã –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–º–µ—Ç–∫–∞ –ø—Ä–æ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é ¬´–∑–∞–≥—Ä—É–∑–∫—É¬ª —Å–æ—à–∫–∏.\n\n–û—Ç–¥–µ–ª—å–Ω–æ —Ä–∞–∑–æ–±—Ä–∞–ª–∏, –∫–∞–∫ –Ω–µ –æ—à–∏–±–∏—Ç—å—Å—è —Å –≤–µ—Ä—Å–∏–µ–π: –∫—Ä–µ–ø–ª–µ–Ω–∏–µ (Picatinny/Stud), –Ω—É–∂–Ω–∞—è –≤—ã—Å–æ—Ç–∞, –ø–∞–Ω–æ—Ä–∞–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤—ã–±–æ—Ä ¬´–ø—è—Ç–∞–∫–æ–≤¬ª –ø–æ–¥ –≥—Ä—É–Ω—Ç/—Å–Ω–µ–≥/–∫–∞–º–µ–Ω—å.  \n#–æ—Ö–æ—Ç–∞ #—Å–æ—à–∫–∏ #—Ç–æ—á–Ω–∞—è—Å—Ç—Ä–µ–ª—å–±–∞"
        }
      }
    ],
    "LLM: –õ–æ–Ω–≥—Ä–∏–¥": [
      {
        "json": {
          "output": "<b>–ß—Ç–æ –∑–∞ —Ç–æ–≤–∞—Ä</b><br/>\n<b>Atlas BT65-LW17 Gen. 2 CAL</b> ‚Äî —ç—Ç–æ –ø—Ä–µ–º–∏–∞–ª—å–Ω–∞—è —Ç–µ–ª–µ—Å–∫–æ–ø–∏—á–µ—Å–∫–∞—è —Å–æ—à–∫–∞ –¥–ª—è –æ—Ö–æ—Ç–Ω–∏—á—å–∏—Ö –∏ —Ç–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –≤–∏–Ω—Ç–æ–≤–æ–∫, —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è –Ω–∞ —É–≤–µ—Ä–µ–Ω–Ω—É—é —Å—Ç—Ä–µ–ª—å–±—É —Å —É–ø–æ—Ä–∞ (–∑–µ–º–ª—è, –∫–∞–ø–æ—Ç, –±—Ä–µ–≤–Ω–æ, —Ä—é–∫–∑–∞–∫) –∏ —Ç–æ—á–Ω—É—é —Ä–∞–±–æ—Ç—É –ø–æ –º–µ—Å—Ç—É. –ú–æ–¥–µ–ª—å –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –ª–∏–Ω–µ–π–∫–µ Atlas —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ–π –∫–æ–º–ø–æ–Ω–æ–≤–∫–æ–π: –¥–≤–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –Ω–æ–≥–∏ —Å —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–æ–π –¥–ª–∏–Ω—ã, —Ä–∞–∑–≤–∏—Ç–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–∫–ª–æ–Ω–∞/–ø–∞–Ω–æ—Ä–∞–º–∏—Ä–æ–≤–∞–Ω–∏—è (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏–∏) –∏ –ø—Ä–æ—á–Ω–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è, –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤—ã—Å—Ç—Ä–µ–ª–∞ –∏ –ø–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç—å –≤–∫–ª–∞–¥–∫–∏.<br/><br/>\n<i>–í–∞–∂–Ω–æ:</i> —É Atlas –µ—Å—Ç—å –≤–∞—Ä–∏–∞—Ü–∏–∏ –ø–æ –∫—Ä–µ–ø–ª–µ–Ω–∏—é (Picatinny/Weaver –∏–ª–∏ –∞–Ω—Ç–∞–±–æ—á–Ω—ã–π Stud), –∞ –∏–Ω–¥–µ–∫—Å <b>CAL</b> —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏/–ø–∞—Ä—Ç–∏–∏. –ü–µ—Ä–µ–¥ –ø–æ–∫—É–ø–∫–æ–π —É—Ç–æ—á–Ω–∏—Ç–µ —Ç–∏–ø –∫—Ä–µ–ø–ª–µ–Ω–∏—è –∏ –Ω–∞–ª–∏—á–∏–µ –ø–∞–Ω–æ—Ä–∞–º–∏—Ä–æ–≤–∞–Ω–∏—è (panning) —É –≤–∞—à–µ–π –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏–∏.\n\n<br/><br/>\n<b>–ö–æ–º—É –ø–æ–¥—Ö–æ–¥–∏—Ç</b><br/>\n<ul>\n  <li><b>–û—Ö–æ—Ç–Ω–∏–∫–∞–º –Ω–∞ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞—Ö</b> (—Å—Ç–µ–ø—å/–ø–æ–ª—è/–≥–æ—Ä—ã), –≥–¥–µ —á–∞—Å—Ç–æ —Å—Ç—Ä–µ–ª—è—é—Ç –ª—ë–∂–∞ –∏ –≤–∞–∂–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –æ–ø–æ—Ä–∞.</li>\n  <li><b>–¢–µ–º, –∫—Ç–æ –æ—Ö–æ—Ç–∏—Ç—Å—è ¬´–∏–∑ –∑–∞—Å–∏–¥–∫–∏¬ª</b> –∏ —Ö–æ—á–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—É—é —Ç–æ—á–∫—É –ø—Ä–∏—Ü–µ–ª–∏–≤–∞–Ω–∏—è –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º –æ–∂–∏–¥–∞–Ω–∏–∏.</li>\n  <li><b>–°—Ç—Ä–µ–ª–∫–∞–º —Å —Ç—è–∂—ë–ª—ã–º–∏ –∫–∞–ª–∏–±—Ä–∞–º–∏/–∂—ë—Å—Ç–∫–æ–π –æ—Ç–¥–∞—á–µ–π</b>, –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω–∞ –∂—ë—Å—Ç–∫–∞—è, –Ω–µ ¬´–≤–∞—Ç–Ω–∞—è¬ª —Å–æ—à–∫–∞, –Ω–µ —É—Ö–æ–¥—è—â–∞—è –≤ —Å—Ç–æ—Ä–æ–Ω—ã –Ω–∞ –≤—ã—Å—Ç—Ä–µ–ª–µ.</li>\n  <li><b>–õ—é–±–∏—Ç–µ–ª—è–º —Ç–æ—á–Ω–æ–π —Å—Ç—Ä–µ–ª—å–±—ã</b> (–∫–æ–Ω—Ç—Ä–æ–ª—å –∫—É—á–Ω–æ—Å—Ç–∏, –ø—Ä–∏—Å—Ç—Ä–µ–ª–∫–∞, —Å—Ç—Ä–µ–ª—å–±–∞ –ø–æ —Å—É—Ä–∫—É/–ª–∏—Å–∏—Ü–µ), –∫–æ–≥–¥–∞ –≤–∞–∂–Ω—ã –º–∏–∫—Ä–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤–∏–Ω—Ç–æ–≤–∫–∏.</li>\n  <li><b>–¢–µ–º, –∫—Ç–æ —á–∞—Å—Ç–æ –º–µ–Ω—è–µ—Ç –ø–æ–∑–∏—Ü–∏–∏</b>: —Ä–∞–∑–Ω–∞—è –≤—ã—Å–æ—Ç–∞ —Ç—Ä–∞–≤—ã/—Å–Ω–µ–≥–∞/–∫–∞–º–Ω–µ–π ‚Äî —Ç–µ–ª–µ—Å–∫–æ–ø–∏—á–µ—Å–∫–∏–µ –Ω–æ–≥–∏ —É–¥–æ–±–Ω–µ–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö.</li>\n</ul>\n\n<b>–ü–ª—é—Å—ã</b><br/>\n<ul>\n  <li><b>–í—ã—Å–æ–∫–∞—è –∂—ë—Å—Ç–∫–æ—Å—Ç—å –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</b>: –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è Atlas –æ–±—ã—á–Ω–æ –º–µ–Ω—å—à–µ ¬´–∏–≥—Ä–∞–µ—Ç¬ª –Ω–∞ –≤—ã—Å—Ç—Ä–µ–ª–µ –∏ –ª—É—á—à–µ –¥–µ—Ä–∂–∏—Ç –ª–∏–Ω–∏—é –ø—Ä–∏—Ü–µ–ª–∏–≤–∞–Ω–∏—è, —á–µ–º –º–Ω–æ–≥–∏–µ –±—é–¥–∂–µ—Ç–Ω—ã–µ –∞–Ω–∞–ª–æ–≥–∏.</li>\n  <li><b>–¢–æ—á–Ω–∞—è —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ –≤—ã—Å–æ—Ç—ã</b>: –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –Ω–æ–≥–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –±—ã—Å—Ç—Ä–æ ¬´–ø–æ–π–º–∞—Ç—å¬ª –≥–æ—Ä–∏–∑–æ–Ω—Ç –Ω–∞ –Ω–µ—Ä–æ–≤–Ω–æ–º —Ä–µ–ª—å–µ—Ñ–µ.</li>\n  <li><b>–ë—ã—Å—Ç—Ä–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –º–µ—Å—Ç–Ω–æ—Å—Ç—å</b>: —É–¥–æ–±–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —É–∫–ª–æ–Ω–æ–≤, –∫–æ—á–µ–∫, –∫–∞–º–Ω–µ–π, –Ω–∞ —Å–∫–ª–æ–Ω–µ.</li>\n  <li><b>–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ —Ä–µ—Å—É—Ä—Å</b>: —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞ –Ω–∞ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—É—é —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é, —Ä–µ–≥—É–ª—è—Ä–Ω—É—é —Å—Ç—Ä–µ–ª—å–±—É –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫—É.</li>\n  <li><b>–£–¥–æ–±—Å—Ç–≤–æ –ø—Ä–∏ –ø—Ä–∏—Å—Ç—Ä–µ–ª–∫–µ</b>: –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä—è–µ–º–æ —É–∫–ª–∞–¥—ã–≤–∞—Ç—å –≤–∏–Ω—Ç–æ–≤–∫—É, —Å–Ω–∏–∂–∞—è –≤–ª–∏—è–Ω–∏–µ –æ—à–∏–±–æ–∫ —É–¥–µ—Ä–∂–∞–Ω–∏—è.</li>\n</ul>\n\n<b>–ú–∏–Ω—É—Å—ã</b><br/>\n<ul>\n  <li><b>–¶–µ–Ω–∞</b>: Atlas ‚Äî —ç—Ç–æ –≤–µ—Ä—Ö–Ω–∏–π —Å–µ–≥–º–µ–Ω—Ç, –∏ –ø–µ—Ä–µ–ø–ª–∞—Ç–∞ –±—É–¥–µ—Ç –∑–∞–º–µ—Ç–Ω–∞, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —Å–æ—à–∫–∞ –Ω—É–∂–Ω–∞ ¬´–Ω–∞ –ø–∞—Ä—É –≤—ã–µ–∑–¥–æ–≤ –≤ –≥–æ–¥¬ª.</li>\n  <li><b>–í–µ—Å –∏ –≥–∞–±–∞—Ä–∏—Ç</b> –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —É–ª—å—Ç—Ä–∞–ª—ë–≥–∫–∏—Ö –æ—Ö–æ—Ç–Ω–∏—á—å–∏—Ö —Å–æ—à–µ–∫: –Ω–∞ —Ö–æ–¥–æ–≤–æ–π –æ—Ö–æ—Ç–µ –∫–∞–∂–¥—ã–π –≥—Ä–∞–º–º –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∞–∂–µ–Ω.</li>\n  <li><b>–°–ª–æ–∂–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞ –≤–µ—Ä—Å–∏–∏</b>: —Ä–∞–∑–Ω—ã–µ –∫—Ä–µ–ø–ª–µ–Ω–∏—è, —Ä–∞–∑–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–Ω–∞–∫–ª–æ–Ω/–ø–∞–Ω/—Å—Ç–æ–ø–æ—Ä—ã), —Ä–∞–∑–Ω—ã–µ ¬´–ø—è—Ç–∞–∫–∏¬ª ‚Äî –ª–µ–≥–∫–æ –≤–∑—è—Ç—å –Ω–µ —Ç–æ.</li>\n  <li><b>–¢—Ä–µ–±—É–µ—Ç –ø—Ä–∏–≤—ã—á–∫–∏</b>: –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Å–æ—à–∫–∏ (preload) –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å ¬´–ø–æ–¥–ø—Ä—ã–≥–∏–≤–∞–Ω–∏–µ¬ª/—Å—Ä—ã–≤ –≤ –º–æ–º–µ–Ω—Ç –≤—ã—Å—Ç—Ä–µ–ª–∞.</li>\n</ul>\n\n<blockquote>\n<b>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–º–µ—Ç–∫–∞:</b> –ø—Ä–µ–º–∏–∞–ª—å–Ω–∞—è —Å–æ—à–∫–∞ –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Ç–µ—Ö–Ω–∏–∫—É. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –æ—Ç–¥–∞—á–∞ –æ—Ç Atlas –ø–æ—è–≤–ª—è–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –≤—ã –æ–¥–∏–Ω–∞–∫–æ–≤–æ ¬´–∑–∞–≥—Ä—É–∂–∞–µ—Ç–µ¬ª —Å–æ—à–∫—É –∫–æ—Ä–ø—É—Å–æ–º –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç–µ –ø—Ä–∏–∫–ª–∞–¥, –∞ –Ω–µ ¬´–∫–ª–∞–¥—ë—Ç–µ –≤–∏–Ω—Ç–æ–≤–∫—É –∫–∞–∫ –ø–æ–ø–∞–ª–æ¬ª.\n</blockquote>\n\n<b>–°–æ–≤–µ—Ç—ã –ø–æ –≤—ã–±–æ—Ä—É (—á—Ç–æ–±—ã –Ω–µ –æ—à–∏–±–∏—Ç—å—Å—è —Å Atlas BT65-LW17 Gen. 2 CAL)</b><br/>\n<ul>\n  <li><b>–£—Ç–æ—á–Ω–∏—Ç–µ —Ç–∏–ø –∫—Ä–µ–ø–ª–µ–Ω–∏—è</b>:\n    <ul>\n      <li>–µ—Å–ª–∏ –Ω–∞ –ª–æ–∂–µ/—Ü–µ–≤—å–µ <b>Picatinny</b> ‚Äî —É–¥–æ–±–Ω–µ–µ –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–¥ –ø–ª–∞–Ω–∫—É (–±—ã—Å—Ç—Ä–µ–µ —Å–Ω—è—Ç—å/–ø–æ—Å—Ç–∞–≤–∏—Ç—å, –º–µ–Ω—å—à–µ –ª—é—Ñ—Ç–æ–≤ –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º –∫—Ä–æ–Ω—à—Ç–µ–π–Ω–µ);</li>\n      <li>–µ—Å–ª–∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è <b>–∞–Ω—Ç–∞–±–∫–∞ (Stud)</b> ‚Äî –±–µ—Ä–∏—Ç–µ –≤–µ—Ä—Å–∏—é –ø–æ–¥ Stud –∏–ª–∏ —Å—Ä–∞–∑—É –ø–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∞–¥–∞–ø—Ç–µ—Ä.</li>\n    </ul>\n  </li>\n  <li><b>–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ä–∞–±–æ—á—É—é –≤—ã—Å–æ—Ç—É</b>: BT65 –æ–±—ã—á–Ω–æ –≤—ã–±–∏—Ä–∞—é—Ç –ø–æ–¥ —Å—Ç—Ä–µ–ª—å–±—É –ª—ë–∂–∞ –∏ —Å –Ω–∏–∑–∫–∏—Ö —É–ø–æ—Ä–æ–≤. –ï—Å–ª–∏ —á–∞—Å—Ç–æ —Å—Ç—Ä–µ–ª—è–µ—Ç–µ –∏–∑ –≤—ã—Å–æ–∫–æ–π —Ç—Ä–∞–≤—ã/—Å–Ω–µ–≥–∞ –∏–ª–∏ —Å –∫–æ–ª–µ–Ω–∞ ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–Ω–∞ –º–æ–¥–µ–ª—å —Å –±–æ–ª—å—à–∏–º –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º –≤—ã—Å–æ—Ç—ã.</li>\n  <li><b>–ù—É–∂–µ–Ω –ª–∏ ¬´–ø–∞–Ω¬ª (–ø–æ–≤–æ—Ä–æ—Ç –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç—É)</b>: –¥–ª—è –æ—Ö–æ—Ç—ã –ø–æ –¥–≤–∏–∂—É—â–µ–π—Å—è —Ü–µ–ª–∏ –∏–ª–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –ø–æ —Ä–∞–∑–Ω—ã–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º, –Ω–µ –º–µ–Ω—è—è –ø–æ–∑–∏—Ü–∏—é, –ø–∞–Ω–æ—Ä–∞–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–∑–Ω–æ. –î–ª—è —á–∏—Å—Ç–æ–π ¬´—Ç–æ—á–Ω–æ—Å—Ç–∏¬ª –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é—Ç –∂—ë—Å—Ç—á–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Å–æ—à–∫—É.</li>\n  <li><b>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –≤–∞—à–∏–º –ª–æ–∂–µ–º/—Ü–µ–≤—å—ë–º</b>: –≤–∞–∂–Ω–æ, —á—Ç–æ–±—ã –ø—Ä–∏ —Å–∫–ª–∞–¥—ã–≤–∞–Ω–∏–∏ –Ω–æ–≥–∏ –Ω–µ —É–ø–∏—Ä–∞–ª–∏—Å—å –≤ —Å—Ç–≤–æ–ª, –∞–Ω—Ç–∞–±–∫—É, –î–¢–ö –∏–ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã —Ä–µ–º–Ω—è.</li>\n  <li><b>–ü–æ–¥–±–µ—Ä–∏—Ç–µ –æ–ø–æ—Ä—ã (–ø—è—Ç–∫–∏)</b> –ø–æ–¥ —É—Å–ª–æ–≤–∏—è:\n    <ul>\n      <li>—Ä–µ–∑–∏–Ω–∞ ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ –∏ —Ç–∏—Ö–æ –Ω–∞ –∫–∞–º–Ω–µ/–º–µ—Ç–∞–ª–ª–µ;</li>\n      <li>—à–∏–ø—ã/–∫–æ–≥—Ç–∏ ‚Äî –¥–ª—è –≥—Ä—É–Ω—Ç–∞, –ª—å–¥–∞, –¥–µ—Ä–Ω–∞, —á—Ç–æ–±—ã —Å–æ—à–∫–∞ –Ω–µ ¬´—É–µ–∑–∂–∞–ª–∞¬ª;</li>\n      <li>—à–∏—Ä–æ–∫–∏–µ ¬´–ª—ã–∂–∏¬ª ‚Äî –¥–ª—è –ø–µ—Å–∫–∞/—Å–Ω–µ–≥–∞.</li>\n    </ul>\n  </li>\n  <li><b>–ü–æ–¥—É–º–∞–π—Ç–µ –ø—Ä–æ —Ä–µ–º–µ–Ω—å</b>: –µ—Å–ª–∏ —Å–æ—à–∫–∞ —Å—Ç–∞–≤–∏—Ç—Å—è –≤ —Ç–æ—á–∫—É –∫—Ä–µ–ø–ª–µ–Ω–∏—è —Ä–µ–º–Ω—è, –ø—Ä–æ–¥—É–º–∞–π—Ç–µ, –∫–∞–∫ –±—É–¥–µ—Ç–µ –Ω–æ—Å–∏—Ç—å –≤–∏–Ω—Ç–æ–≤–∫—É (–∏–Ω–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π QD-—Å–ª–æ—Ç/–∞–Ω—Ç–∞–±–∫–∞).</li>\n</ul>\n\n<b>–í—ã–≤–æ–¥</b><br/>\n<b>Atlas BT65-LW17 Gen. 2 CAL</b> ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è –æ—Ö–æ—Ç–Ω–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–ª—å–Ω–æ —Å—Ç—Ä–µ–ª—è–µ—Ç —Å —Å–æ—à–µ–∫ –∏ —Ö–æ—á–µ—Ç –º–∞–∫—Å–∏–º—É–º —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏, –∂—ë—Å—Ç–∫–æ—Å—Ç–∏ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç–∏ –≤—ã—Å—Ç—Ä–µ–ª–∞. –û–Ω–∞ –æ—Å–æ–±–µ–Ω–Ω–æ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –¥–∞–ª—å–Ω–∏—Ö/—Ç–æ—á–Ω—ã—Ö –≤—ã—Å—Ç—Ä–µ–ª–∞—Ö –∏ –≤ —Å–ª–æ–∂–Ω–æ–º —Ä–µ–ª—å–µ—Ñ–µ, –≥–¥–µ –±—é–¥–∂–µ—Ç–Ω—ã–µ —Å–æ—à–∫–∏ —á–∞—Å—Ç–æ ¬´–≥—É–ª—è—é—Ç¬ª –∏ —Ç—Ä–µ–±—É—é—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –ø–æ–ø—Ä–∞–≤–æ–∫ –ø–æ –ø–æ–ª–æ–∂–µ–Ω–∏—é. –ï—Å–ª–∏ –∂–µ –æ—Ö–æ—Ç–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ö–æ–¥–æ–≤–∞—è –∏ –≤—ã —Ä–µ–¥–∫–æ —Å—Ç—Ä–µ–ª—è–µ—Ç–µ –ª—ë–∂–∞, –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –≤–∑–≤–µ—Å–∏—Ç—å —Ü–µ–Ω—É/–≤–µ—Å –∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –±–æ–ª–µ–µ –ª—ë–≥–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è.<br/><br/>\n<i>–ï—Å–ª–∏ –Ω–∞–ø–∏—à–µ—Ç–µ, –∫–∞–∫–∞—è —É –≤–∞—Å –≤–∏–Ω—Ç–æ–≤–∫–∞ –∏ –∫–∞–∫–æ–µ –∫—Ä–µ–ø–ª–µ–Ω–∏–µ (Picatinny –∏–ª–∏ –∞–Ω—Ç–∞–±–∫–∞), –∞ —Ç–∞–∫–∂–µ —Ç–∏–ø –æ—Ö–æ—Ç—ã (—Ö–æ–¥–æ–≤–∞—è/–∑–∞—Å–∏–¥–∫–∞/–≥–æ—Ä—ã), –ø–æ–¥—Å–∫–∞–∂—É, –ø–æ–¥—Ö–æ–¥–∏—Ç –ª–∏ –∏–º–µ–Ω–Ω–æ BT65 –ø–æ –≤—ã—Å–æ—Ç–µ –∏ –∫–∞–∫—É—é –≤–µ—Ä—Å–∏—é –∫—Ä–µ–ø–ª–µ–Ω–∏—è –ª—É—á—à–µ –±—Ä–∞—Ç—å.</i>"
        }
      }
    ]
  },
  "connections": {
    "AI Agent": {
      "main": [
        [
          {
            "node": "Send a text message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model4": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model5": {
      "ai_languageModel": [
        [
          {
            "node": "LLM: –õ–æ–Ω–≥—Ä–∏–¥",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model6": {
      "ai_languageModel": [
        [
          {
            "node": "LLM: –ê–Ω–æ–Ω—Å",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model7": {
      "ai_languageModel": [
        [
          {
            "node": "–ó–∞–≥–æ–ª–æ–≤–æ–∫",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Postgres (Get Factpack)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "–ë–î: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∞–≤–∫–∏",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute a SQL query in Postgres": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Send a text message": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute a SQL query": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Postgres (Get Factpack)": {
      "main": [
        [
          {
            "node": "–°–æ–µ–¥–∏–Ω–∏—Ç—å",
            "type": "main",
            "index": 1
          },
          {
            "node": "–ü–æ–ª—É—á–∏—Ç—å —á–∞—Ç—ã –∏ –ø—Ä–æ–º—Ç—ã",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –ê–ø—Ä—É–≤-2 (–∞–Ω–æ–Ω—Å)": {
      "main": [
        [
          {
            "node": "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ID –∞–Ω–æ–Ω—Å–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ö–æ–¥: –†–∞–∑–±–∏—Ç—å –ª–æ–Ω–≥—Ä–∏–¥ –¥–ª—è –¢–ì": {
      "main": [
        [
          {
            "node": "–¶–∏–∫–ª: –ß–∞—Å—Ç–∏ –ª–æ–Ω–≥—Ä–∏–¥–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–¶–∏–∫–ª: –ß–∞—Å—Ç–∏ –ª–æ–Ω–≥—Ä–∏–¥–∞": {
      "main": [
        [
          {
            "node": "TG: –ê–ø—Ä—É–≤-2 (–∫–Ω–æ–ø–∫–∏)1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "TG: –ê–ø—Ä—É–≤-2 (–ª–æ–Ω–≥—Ä–∏–¥ —á–∞—Å—Ç—å)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –ê–ø—Ä—É–≤-2 (–ª–æ–Ω–≥—Ä–∏–¥ —á–∞—Å—Ç—å)": {
      "main": [
        [
          {
            "node": "–ë–î: –î–æ–±–∞–≤–∏—Ç—å ID –≤ –º–∞—Å—Å–∏–≤",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ü–æ–ª—É—á–∏—Ç—å —á–∞—Ç—ã –∏ –ø—Ä–æ–º—Ç—ã": {
      "main": [
        [
          {
            "node": "–°–æ–µ–¥–∏–Ω–∏—Ç—å",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ó–∞–≥–æ–ª–æ–≤–æ–∫": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "LLM: –ê–Ω–æ–Ω—Å": {
      "main": [
        [
          {
            "node": "–ó–∞–≥–æ–ª–æ–≤–æ–∫",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge2",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "LLM: –õ–æ–Ω–≥—Ä–∏–¥": {
      "main": [
        [
          {
            "node": "LLM: –ê–Ω–æ–Ω—Å",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DB: Save Drafts": {
      "main": [
        [
          {
            "node": "–≠—Ç–æ —Ñ–∞–π–ª –∏–ª–∏ —Ñ–æ—Ç–æ?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge2": {
      "main": [
        [
          {
            "node": "DB: Save Drafts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "–°–æ–µ–¥–∏–Ω–∏—Ç—å": {
      "main": [
        [
          {
            "node": "LLM: –õ–æ–Ω–≥—Ä–∏–¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –ê–ø—Ä—É–≤-2 (—Ñ–æ—Ç–æ)": {
      "main": [
        [
          {
            "node": "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ID —Ñ–æ—Ç–æ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∞–≤–∫–∏": {
      "main": [
        [
          {
            "node": "–†–æ—É—Ç–µ—Ä: –ö–Ω–æ–ø–∫–∞ –∏–ª–∏ –¢–µ–∫—Å—Ç?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–†–æ—É—Ç–µ—Ä: –ö–Ω–æ–ø–∫–∞ –∏–ª–∏ –¢–µ–∫—Å—Ç?": {
      "main": [
        [
          {
            "node": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Execute a SQL query",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "–ë–î: –ü–æ–ª—É—á–∏—Ç—å ID —á–∞—Ç–æ–≤": {
      "main": [
        [
          {
            "node": "–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ–±–∑–æ—Ä–∞": {
      "main": [
        [
          {
            "node": "–ï—Å–ª–∏: –≠—Ç–æ –∫–Ω–æ–ø–∫–∞?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ï—Å–ª–∏: –≠—Ç–æ –∫–Ω–æ–ø–∫–∞?": {
      "main": [
        [
          {
            "node": "TG: Answer Callback",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–ï—Å–ª–∏: –≠—Ç–æ –≥–æ–ª–æ—Å?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: Answer Callback": {
      "main": [
        [
          {
            "node": "Switch: –î–µ–π—Å—Ç–≤–∏–µ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch: –î–µ–π—Å—Ç–≤–∏–µ": {
      "main": [
        [
          {
            "node": "TG: –í—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–ë–î: –°—Ç–∞—Ä—Ç –ø—Ä–∞–≤–∫–∏ (R2)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "TG: –£–¥–∞–ª–∏—Ç—å –∫–Ω–æ–ø–∫–∏ (X2)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "TG: –ó–∞–ø—Ä–æ—Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–ë–î: –î–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å –†–µ—Ü–µ–ø—Ç—ã",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "TG: –°–ø—Ä–æ—Å–∏—Ç—å –¥–∞—Ç—É",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –£–¥–∞–ª–∏—Ç—å –∫–Ω–æ–ø–∫–∏ (X2)": {
      "main": [
        [
          {
            "node": "–ë–î: –°–∫–∏–ø (X2)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –ó–∞–ø—Ä–æ—Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏": {
      "main": [
        [
          {
            "node": "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ü–µ–ª—å –ø—Ä–∞–≤–∫–∏",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –°–ø—Ä–æ—Å–∏—Ç—å –¥–∞—Ç—É": {
      "main": [
        [
          {
            "node": "–ë–î: –ñ–¥–µ–º –¥–∞—Ç—É",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ï—Å–ª–∏: –≠—Ç–æ –≥–æ–ª–æ—Å?": {
      "main": [
        [
          {
            "node": "TG: –°–∫–∞—á–∞—Ç—å –∞—É–¥–∏–æ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –°–∫–∞—á–∞—Ç—å –∞—É–¥–∏–æ": {
      "main": [
        [
          {
            "node": "OpenAI: –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI: –¢—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è": {
      "main": [
        [
          {
            "node": "–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ß—Ç–æ –ø—Ä–∞–≤–∏–º?": {
      "main": [
        [
          {
            "node": "AI: –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∞–Ω–æ–Ω—Å",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI: –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ª–æ–Ω–≥—Ä–∏–¥",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI: –ü—Ä–æ–º—Ç –¥–ª—è DALL-E",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI: –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç—ã",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (–ü–ª–∞–Ω)": {
      "main": [
        [
          {
            "node": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –î–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è": {
      "main": [
        [
          {
            "node": "TG: –í–µ—Ä–Ω—É—Ç—å –º–µ–Ω—é",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É—é –ø—Ä–∞–≤–∫—É": {
      "main": [
        [
          {
            "node": "–ß—Ç–æ –ø—Ä–∞–≤–∏–º?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –°—Ç–∞—Ä—Ç –ø—Ä–∞–≤–∫–∏ (R2)": {
      "main": [
        [
          {
            "node": "TG: –ú–µ–Ω—é –ø—Ä–∞–≤–æ–∫",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–Ω–≥—Ä–∏–¥": {
      "main": [
        [
          {
            "node": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –û–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É": {
      "main": [
        [
          {
            "node": "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ + –∫–Ω–æ–ø–∫–∏1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –£–¥–∞–ª–∏—Ç—å –º–µ–Ω—é –≤—Ä–µ–º–µ–Ω–∏": {
      "main": [
        [
          {
            "node": "TG: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (Now)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –û–±–Ω–æ–≤–∏—Ç—å –∞–Ω–æ–Ω—Å": {
      "main": [
        [
          {
            "node": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç": {
      "main": [
        [
          {
            "node": "–ë–î: –ù–∞–π—Ç–∏ –∞–∫—Ç–∏–≤–Ω—É—é –ø—Ä–∞–≤–∫—É",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ": {
      "main": [
        [
          {
            "node": "TG: –£–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç —é–∑–µ—Ä–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –£–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç —é–∑–µ—Ä–∞": {
      "main": [
        [
          {
            "node": "TG: –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å –±–æ—Ç–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å –±–æ—Ç–∞": {
      "main": [
        [
          {
            "node": "–û–±–Ω–æ–≤–∏—Ç—å –∞–Ω–æ–Ω—Å",
            "type": "main",
            "index": 0
          },
          {
            "node": "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ + –∫–Ω–æ–ø–∫–∏",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ1": {
      "main": [
        [
          {
            "node": "TG: –£–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç —é–∑–µ—Ä–∞1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –£–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç —é–∑–µ—Ä–∞1": {
      "main": [
        [
          {
            "node": "TG: –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å –±–æ—Ç–∞1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å –±–æ—Ç–∞1": {
      "main": [
        [
          {
            "node": "–ö–æ–¥: –ê–Ω–∞–ª–∏–∑ (Edit –∏–ª–∏ Rebuild?)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ö–æ–¥: –ê–Ω–∞–ª–∏–∑ (Edit –∏–ª–∏ Rebuild?)": {
      "main": [
        [
          {
            "node": "IF: –ú–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–∏—Ç—å?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ2": {
      "main": [
        [
          {
            "node": "TG: –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å –±–æ—Ç–∞2",
            "type": "main",
            "index": 0
          },
          {
            "node": "TG: –£–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç —é–∑–µ—Ä–∞2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge3",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ3": {
      "main": [
        [
          {
            "node": "TG: –£–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç —é–∑–µ—Ä–∞3",
            "type": "main",
            "index": 0
          },
          {
            "node": "TG: –£–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å –±–æ—Ç–∞3",
            "type": "main",
            "index": 0
          },
          {
            "node": "TG: –£–¥–∞–ª–∏—Ç—å –º–µ–Ω—é –≤—Ä–µ–º–µ–Ω–∏1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –ü–æ–ª—É—á–∏—Ç—å –†–µ—Ü–µ–ø—Ç—ã": {
      "main": [
        [
          {
            "node": "–ö–æ–¥: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Jobs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ö–æ–¥: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Jobs": {
      "main": [
        [
          {
            "node": "Create a row",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create a row": {
      "main": [
        [
          {
            "node": "–ë–î: –°—Ç–∞—Ç—É—Å Approved",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –ü–æ–ª—É—á–∏—Ç—å –†–µ—Ü–µ–ø—Ç—ã1": {
      "main": [
        [
          {
            "node": "–ö–æ–¥: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Jobs1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ö–æ–¥: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Jobs1": {
      "main": [
        [
          {
            "node": "–°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –°—Ç–∞—Ç—É—Å Approved1": {
      "main": [
        [
          {
            "node": "TG: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ (–ü–ª–∞–Ω)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI: –ü—Ä–æ–º—Ç –¥–ª—è DALL-E": {
      "main": [
        [
          {
            "node": "OpenRouter: Image1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI: –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∞–Ω–æ–Ω—Å": {
      "main": [
        [
          {
            "node": "–ë–î: –û–±–Ω–æ–≤–∏—Ç—å –∞–Ω–æ–Ω—Å",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI: –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç—ã": {
      "main": [
        [
          {
            "node": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å –†–µ—Ü–µ–ø—Ç—ã1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI: –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ª–æ–Ω–≥—Ä–∏–¥": {
      "main": [
        [
          {
            "node": "–ë–î: –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–Ω–≥—Ä–∏–¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF: –ú–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–∏—Ç—å?": {
      "main": [
        [
          {
            "node": "TG: –ü—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–∏—Ç—å (Edit)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–ö–æ–¥: ID –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –ü—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–∏—Ç—å (Edit)": {
      "main": [
        [
          {
            "node": "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ + –∫–Ω–æ–ø–∫–∏2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ö–æ–¥: ID –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è": {
      "main": [
        [
          {
            "node": "–¶–∏–∫–ª: –£–¥–∞–ª–µ–Ω–∏–µ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–¶–∏–∫–ª: –£–¥–∞–ª–µ–Ω–∏–µ": {
      "main": [
        [
          {
            "node": "–ö–æ–¥: –ß–∞–Ω–∫–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "TG: –£–¥–∞–ª–∏—Ç—å (Loop)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –£–¥–∞–ª–∏—Ç—å (Loop)": {
      "main": [
        [
          {
            "node": "–¶–∏–∫–ª: –£–¥–∞–ª–µ–Ω–∏–µ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ö–æ–¥: –ß–∞–Ω–∫–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏": {
      "main": [
        [
          {
            "node": "–¶–∏–∫–ª: –û—Ç–ø—Ä–∞–≤–∫–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–¶–∏–∫–ª: –û—Ç–ø—Ä–∞–≤–∫–∞": {
      "main": [
        [
          {
            "node": "–ö–æ–¥: –°–æ–±—Ä–∞—Ç—å ID (Rebuild)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "TG: –û—Ç–ø—Ä–∞–≤–∏—Ç—å (Loop)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –û—Ç–ø—Ä–∞–≤–∏—Ç—å (Loop)": {
      "main": [
        [
          {
            "node": "–¶–∏–∫–ª: –û—Ç–ø—Ä–∞–≤–∫–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ö–æ–¥: –°–æ–±—Ä–∞—Ç—å ID (Rebuild)": {
      "main": [
        [
          {
            "node": "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–Ω–≥—Ä–∏–¥ (Rebuild)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–Ω–≥—Ä–∏–¥ (Rebuild)": {
      "main": [
        [
          {
            "node": "TG: –ê–ø—Ä—É–≤-2 (–ù–û–í–´–ï –∫–Ω–æ–ø–∫–∏)1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–Ω–æ–ø–∫—É (Rebuild)": {
      "main": [
        [
          {
            "node": "TG: –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–Ω–æ–ø–∫–∏",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –ê–ø—Ä—É–≤-2 (–ù–û–í–´–ï –∫–Ω–æ–ø–∫–∏)1": {
      "main": [
        [
          {
            "node": "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–Ω–æ–ø–∫—É (Rebuild)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ï—Å–ª–∏: –£–∂–µ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –ø—Ä–∞–≤–∫–∞?": {
      "main": [
        [
          {
            "node": "TG: –û—à–∏–±–∫–∞ (–ó–∞–Ω—è—Ç–æ)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω—è—Ç–æ—Å—Ç–∏": {
      "main": [
        [
          {
            "node": "–ï—Å–ª–∏: –£–∂–µ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –ø—Ä–∞–≤–∫–∞?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "–ë–î: –û–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –°—Ç–∞—Ç—É—Å Approved": {
      "main": [
        [
          {
            "node": "TG: –£–¥–∞–ª–∏—Ç—å –º–µ–Ω—é –≤—Ä–µ–º–µ–Ω–∏",
            "type": "main",
            "index": 0
          },
          {
            "node": "Call '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–æ—Ü. —Å–µ—Ç–µ–π'",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏": {
      "main": [
        [
          {
            "node": "–ë–î: –°—Ç–∞—Ç—É—Å Approved1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Call '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–æ—Ü. —Å–µ—Ç–µ–π'1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "r. gpt 5.2": {
      "ai_languageModel": [
        [
          {
            "node": "AI: –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ª–æ–Ω–≥—Ä–∏–¥",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "r. gpt 5.2 (1)": {
      "ai_languageModel": [
        [
          {
            "node": "AI: –ü—Ä–æ–º—Ç –¥–ª—è DALL-E",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "r. gpt 5.2 (2)": {
      "ai_languageModel": [
        [
          {
            "node": "AI: –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∞–Ω–æ–Ω—Å",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "r. gpt 5  nano": {
      "ai_languageModel": [
        [
          {
            "node": "AI: –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞—Ç—ã",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "DataURL -> Binary": {
      "main": [
        [
          {
            "node": "–ë–î: –ü–æ–ª—É—á–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter: Image1": {
      "main": [
        [
          {
            "node": "DataURL -> Binary",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge3": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–≠—Ç–æ —Ñ–∞–π–ª –∏–ª–∏ —Ñ–æ—Ç–æ?": {
      "main": [
        [
          {
            "node": "TG: –ê–ø—Ä—É–≤-2 (—Ñ–∞–π–ª)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "TG: –ê–ø—Ä—É–≤-2 (—Ñ–æ—Ç–æ)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –ê–ø—Ä—É–≤-2 (—Ñ–∞–π–ª)": {
      "main": [
        [
          {
            "node": "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ID —Ñ–æ—Ç–æ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ID —Ñ–æ—Ç–æ": {
      "main": [
        [
          {
            "node": "TG: –ê–ø—Ä—É–≤-2 (–∞–Ω–æ–Ω—Å)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ID –∞–Ω–æ–Ω—Å–∞": {
      "main": [
        [
          {
            "node": "–ö–æ–¥: –†–∞–∑–±–∏—Ç—å –ª–æ–Ω–≥—Ä–∏–¥ –¥–ª—è –¢–ì",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–î: –î–æ–±–∞–≤–∏—Ç—å ID –≤ –º–∞—Å—Å–∏–≤": {
      "main": [
        [
          {
            "node": "–¶–∏–∫–ª: –ß–∞—Å—Ç–∏ –ª–æ–Ω–≥—Ä–∏–¥–∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å?": {
      "main": [
        [
          {
            "node": "Send a text message1",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "TG: –ê–ø—Ä—É–≤-2 (–∫–Ω–æ–ø–∫–∏)1": {
      "main": [
        [
          {
            "node": "–ë–î: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å id –∫–Ω–æ–ø–æ–∫",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TG: –í—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏": {
      "main": [
        []
      ]
    },
    "Call '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Å–æ—Ü. —Å–µ—Ç–µ–π'": {
      "main": [
        []
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "a0622143-6a5f-472a-9731-74633adfbfde",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "a3be3517ac16055c74c794d80ee41ecf8379a31765686f5b788ba2bac8e2a816"
  },
  "id": "R5yHS8oRMdWMxIzA",
  "tags": []
}